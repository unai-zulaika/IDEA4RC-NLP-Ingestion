llama_context: n_ctx_per_seq (8192) < n_ctx_train (131072) -- the full capacity of the model will not be utilized
[INFO] Loading report type prompt mapping from: report_type_prompt_mapping.json
[INFO] Loaded mapping for 7 report types
================================================================================
LLM Evaluation Pipeline for INT Prompts
================================================================================
Mode: Few-shot (k=5)
Report type filtering: ENABLED (7 report types mapped)
================================================================================

[STEP 1] Loading data...
  Loading notes from: /home/zulaika/IDEA4RC-NLP-Ingestion/api/nlp/first_patient_notes.csv
  Loaded 18 notes
  Loading expected annotations from JSON: /home/zulaika/IDEA4RC-NLP-Ingestion/api/nlp/annotated_patient_notes_with_spans_full_verified.json
[INFO] Loading annotations from JSON: /home/zulaika/IDEA4RC-NLP-Ingestion/api/nlp/annotated_patient_notes_with_spans_full_verified.json
[INFO] Loaded annotations for 205 notes
  Loaded annotations for 205 notes
  [Time: 0.03s]

[STEP 2] Adapting prompts...
[INFO] Adapting INT prompts for model_runner...
[INFO] Loaded 27 adapted prompts into model_runner
  [Time: 0.00s]

[STEP 3] Setting up FAISS indexes for few-shot examples...
[INFO] SentenceTransformer using device: cuda
  Building FAISS indexes from patients 2-3...
[INFO] Extracted 2 patients for fewshot building
[INFO] Built FAISS index for 'biopsygrading-int': 10 examples
[INFO] Built FAISS index for 'surgerymargins-int': 26 examples
[INFO] Built FAISS index for 'tumordepth-int': 36 examples
[INFO] Built FAISS index for 'biopsymitoticcount-int': 4 examples
[INFO] Built FAISS index for 'gender-int': 39 examples
[INFO] Built FAISS index for 'reexcision-int': 1 examples
[INFO] Built FAISS index for 'necrosis_in_biopsy-int': 2 examples
[INFO] Built FAISS index for 'previous_cancer_treatment-int': 3 examples
[INFO] Built FAISS index for 'chemotherapy_start-int': 10 examples
[INFO] Built FAISS index for 'surgerytype-fs30-int': 10 examples
[INFO] Built FAISS index for 'radiotherapy_start-int': 9 examples
[INFO] Built FAISS index for 'recurrencetype-int': 12 examples
[INFO] Built FAISS index for 'radiotherapy_end-int': 13 examples
[INFO] Built FAISS index for 'tumorbiopsytype-int': 12 examples
[INFO] Built FAISS index for 'necrosis_in_surgical-int': 7 examples
[INFO] Built FAISS index for 'tumordiameter-int': 39 examples
[INFO] Built FAISS index for 'patient-status-int': 22 examples
[INFO] Built FAISS index for 'response-to-int': 6 examples
[INFO] Built FAISS index for 'stage_at_diagnosis-int': 37 examples
[INFO] Built FAISS index for 'chemotherapy_end-int': 9 examples
[INFO] Built FAISS index for 'occurrence_cancer-int': 8 examples
[INFO] Built FAISS index for 'surgical-specimen-grading-int': 28 examples
[INFO] Built FAISS index for 'ageatdiagnosis-int': 39 examples
[INFO] Built FAISS index for 'recur_or_prog-int': 18 examples
[INFO] Built FAISS index for 'histological-tipo-int': 39 examples
[INFO] Built FAISS index for 'surgical-mitotic-count-int': 7 examples
[INFO] Built FAISS index for 'tumorsite-int': 39 examples

[INFO] Completed: 27 built, 0 skipped/total
  [Time: 6.04s]

[STEP 4] Initializing LLM model...
  Model path: /home/zulaika/IDEA4RC-NLP-Ingestion/api/nlp/meta-llama-3.1-8b-instruct-q4_k_m.gguf
  [INFO] Setting LLAMA_N_GPU_LAYERS=-1 for maximum GPU usage
  [INFO] Using optimized settings: n_ctx=8192, n_batch=1024, flash_attn=True
  [INFO] Note: Processing is sequential (one prompt at a time), not batched
[llama.cpp] init n_gpu_layers=-1, n_threads=71
[llama.cpp] model ready
  Model initialized successfully
  [INFO] pynvml not available for detailed GPU monitoring
  [Time: 3.47s]

[STEP 5] Running LLM inference and evaluation...
  This may take a while...

  Processing note: P001_2018-03-15_consultation_1 (consultation)
    Filtered prompts: 11/27 prompts relevant to consultation
    [1/93] gender-int ... 
    Prompt (5587 chars):
    ----------------------------------------------------------------------
    You are an expert medical annotator specializing in extracting structured clinical information from medical notes. 
    Identify the Patient's gender from the provided medical note. Take note of the singular, third-person pronouns also. Output your response exactly in the following format:
    
    Format:
    Patient's gender [male/female/unknown].
    
    Do not include any explanations, reasoning, extra text, the medical note — only output the annotation value in the specified format above.
    
    ---
    
    Here are few examples for your understanding:
    Example:
    - Medical Note: Paziente F, 85 anni, nota per lesione profonda della parete addominale anteriore trattata con escissione ampia e ricostruzione il 10/06/2022; istologia definitiva (20/06/2022) ha confermato pleomorphic liposarcoma (ICD-O-3 8858/3), FNCLCC grado 3,
        ... [truncated 4787 more characters] ...
    ----------------------------------------------------------------------
✓ Match (sim: 1.00, 16.63s)
  Expected:  Patient's gender Female
  Predicted: Patient's gender: Female
    [2/93] ageatdiagnosis-int ... 
    Prompt (7368 chars):
    ----------------------------------------------------------------------
    You are an expert medical annotator specializing in extracting structured clinical information from oncology notes. Identify the age at diagnosis of the patient from the given medical note and output it in the exact format below.
    
    Format:
    Age at diagnosis [age] years.
    
    The age must be formatted in the above format only starting with 'Age at diagnosis' and followed by the age in number followed by 'years'. Do not add explanations.
    
    ---
    
    Here are few examples for your understanding:
    Example:
    - Medical Note: Paziente F, 85 anni, nota per lesione profonda della parete addominale anteriore trattata con escissione ampia e ricostruzione il 10/06/2022; istologia definitiva (20/06/2022) ha confermato pleomorphic liposarcoma (ICD-O-3 8858/3), FNCLCC grado 3, dimensione massima 200 mm, margine profon
        ... [truncated 6568 more characters] ...
    ----------------------------------------------------------------------
✓ Match (sim: 1.00, 21.33s)
  Expected:  Age at diagnosis 34 years
  Predicted: Age at diagnosis 34 years.
    [3/93] tumorsite-int ... 
    Prompt (8508 chars):
    ----------------------------------------------------------------------
    Task:
    You are a clinical information extraction assistant.
    From the provided medical note, identify the tumor location category and the exact tumor site.
    
    Instructions:
    
    1. Read the note carefully and find the actual tumor site mentioned for the current case, not historical disease, treatment site, or previous surgery.
    
    2. Determine the broader anatomical category that best fits the tumor site (e.g., Upper and Lower limbs, Trunk wall, Intra abdominal, Genito urinary, Head and neck, Breast).
    
    3. Then specify the exact site (e.g., Upper leg, Groin, Thoracic wall, Paravertebral – thoracolumbar, skin of right breast, etc.).
    
    4. When both an organ and a surface or subregion are mentioned, prioritize the most specific surface or subregion (e.g., “skin of right breast” → not Breast).
    
    5. When ter
        ... [truncated 7708 more characters] ...
    ----------------------------------------------------------------------
✓ Match (sim: 0.82, 22.84s)
  Expected:  Tumor site (Upper and Lower limbs): left thigh (anterior compartment)
  Predicted: Tumor site (Upper and Lower limbs): Anterior thigh.
    [4/93] tumordiameter-int ... 
    Prompt (6666 chars):
    ----------------------------------------------------------------------
    You are an expert medical annotator specializing in oncology pathology. Your task is to extract extract the tumor longest diameter (in mm) and the date from the provided medical note and output it in a precise, templated format.
    
    Formats:
    Tumor longest diameter: [value]mm (at initial imaging on [date]).
    Tumor longest diameter unknown.
    
    If the date is missing, output [put date].  
    
    ---
    
    Here are few examples for your understanding:
    Example:
    - Medical Note: Paziente femmina, diagnostico di liposarcoma pleomorfo della parete addominale anteriore (ICD-O-3 8858/3), FNCLCC grado 3, dimensione massima 200 mm. In anamnesi: escissione chirurgica ampia con ricostruzione effettuata il 10/06/2022; esame istologico definitivo datato 20/06/2022 confermava resezione con margine profondo R1.
    - Annotation:
        ... [truncated 5866 more characters] ...
    ----------------------------------------------------------------------
✓ Match (sim: 1.00, 19.10s)
  Expected:  Tumor longest diameter: 110 mm (at initial imaging on 2018-03-15)
  Predicted: Tumor longest diameter: 110 mm (at initial imaging on 15/03/2018).
    [5/93] tumordepth-int ... 
    Prompt (6123 chars):
    ----------------------------------------------------------------------
    You are a clinical information extraction assistant specialized in oncology pathology and radiology reports.
    
    Task:
    From the given medical note, determine the tumor depth and output **only one** of the two values: `superficial` or `deep`.
    
    Output format (exact):
    Annotation: Tumor depth: [superficial|deep].
    
    ---
    
    Here are few examples for your understanding:
    Example:
    - Medical Note: Dati clinici rilevanti: donna 85 anni con massa profonda della parete addominale anteriore, di circa 20 cm di diametro alla RMN eseguita il 02/05/2022; comparsa della tumefazione riportata da circa 3 mesi. ... Commento e raccomandazioni: il quadro istologico è compatibile con un sarcoma di alto grado a differenziazione lipogenica, in linea con l'immagine radiologica di massa profonda subfasciale di 200 mm. Consi
        ... [truncated 5323 more characters] ...
    ----------------------------------------------------------------------
✗ Mismatch (sim: 0.41, 14.78s)
  Expected:  Tumor depth: deep (intramuscular)
  Predicted: Tumor depth: superficial
    [6/93] histological-tipo-int ... 
    Prompt (5900 chars):
    ----------------------------------------------------------------------
    Task: You are a clinical information extraction assistant.
    Your task is to carefully read the given medical note and identify the histological type of the tumor.
    
    Always select only one histological type from the controlled list provided below.
    
    If multiple histological types are mentioned, choose the most specific or final diagnosis.
    
    Output strictly in the following format:
    Annotation: Histological type: [selected type] ([ICD-O-3 code]).
    
    ---
    
    Here are few examples for your understanding:
    Example:
    - Medical Note: Paziente femmina, precedentemente trattata per liposarcoma pleomorfo della parete addominale anteriore (ICD-O-3 8858/3), FNCLCC grado 3, massa di circa 200 mm, sottoposta a escissione ampia con ricostruzione il 10/06/2022; esame istologico definitivo 20/06/2022 confermava pleomo
        ... [truncated 5100 more characters] ...
    ----------------------------------------------------------------------
✓ Match (sim: 0.85, 16.99s)
  Expected:  Histological type: Myxoid liposarcoma (8852/3)
  Predicted: Histological type: Myxoid liposarcoma (ICD-O-3: 8852/3).
    [7/93] biopsygrading-int ... 
    Prompt (5295 chars):
    ----------------------------------------------------------------------
    Task: You are a medical text annotation assistant.
    Your task is to read a given medical note and identify the biopsy grading (FNCLCC) mentioned in the note.
    
    Output strictly in the following format:
    Biopsy grading (FNCLCC): [value].
    
    The values can be from the following options: 1 or  2 or 3 or Other classification system high or Other classification system low or Biopsy grading not applicable or Unknown biopsy grading.
    
    ---
    
    Here are few examples for your understanding:
    Example:
    - Medical Note: Documentazione istologica disponibile: pleomorphic liposarcoma (ICD-O-3 8858/3), FNCLCC grado 3; dimensione massima riportata circa 200 mm.
    - Annotation: Biopsy grading (FNCLCC): Grade 3
    
    Example:
    - Medical Note: Biopsia core del 12/05/2022: sarcoma pleomorfo con differenziazione lipogenica, istoti
        ... [truncated 4495 more characters] ...
    ----------------------------------------------------------------------
✗ Mismatch (sim: 0.78, 13.44s)
  Expected:  Biopsy grading (FNCLCC): 2
  Predicted: Biopsy grading (FNCLCC): Grade 2
    [8/93] tumorbiopsytype-int ... 
    Prompt (6118 chars):
    ----------------------------------------------------------------------
    You are a clinical information extraction assistant.  
    Your task: From the given medical note, extract the biopsy type and the date (if present).  
    If the date is missing, output 'unknown'.  
    If the place is not mentioned, output 'in the hospital'.  
    Always present the output in the following structured format:  
    
    Annotation: Baseline/primary tumor [biopsy type] biopsy has been performed on [date] in [place].
    
    ---
    
    Here are few examples for your understanding:
    Example:
    - Medical Note: Biopsia core del 12/05/2022: sarcoma pleomorfo con differenziazione lipogenica, istotipo coerente con pleomorphic liposarcoma (ICD-O-3 8858/3); grado FNCLCC 3 su materiale bioptico.
    - Annotation: Baseline/primary tumor core needle biopsy has been performed on 12/05/2022 in unknown
    
    Example:
    - Medical Note: Di
        ... [truncated 5318 more characters] ...
    ----------------------------------------------------------------------
✗ Mismatch (sim: 0.00, 16.59s)
  Expected:  [NO EXPECTED ANNOTATION]
  Predicted: Baseline/primary tumor core needle biopsy has been performed on 15/03/2018 in unknown place
    [9/93] stage_at_diagnosis-int ... 
    Prompt (6908 chars):
    ----------------------------------------------------------------------
    You are an expert medical annotator specializing in extracting structured clinical information from medical notes. Identify the stage at diagnosis from the provided medical note. 
    The response must be any one of the following answers: 
    
    Possible Answers: 
    Stage at diagnosis: localized. 
    Stage at diagnosis: loco-regional (In transit metastasis). 
    Stage at diagnosis: metastatic (regional nodal metastases). 
    Unknown stage at diagnosis. 
    
    Do not include any explanations, reasoning, extra text, the medical note.
    
    ---
    
    Here are few examples for your understanding:
    Example:
    - Medical Note: Tac torace-addome-pelvi del 05/05/2022 senza evidenza di metastasi a distanza (staging cM0). Biopsia core del 12/05/2022: sarcoma pleomorfo con differenziazione lipogenica, istotipo coerente con pleomorphic lip
        ... [truncated 6108 more characters] ...
    ----------------------------------------------------------------------
✗ Mismatch (sim: 0.54, 17.24s)
  Expected:  Stage at diagnosis (AJCC/UICC or local staging): localized
  Predicted: Stage at diagnosis: localized.
    [10/93] previous_cancer_treatment-int ... 
    Prompt (6652 chars):
    ----------------------------------------------------------------------
    Task:
    You are a clinical information extraction assistant. From the given medical note, identify and classify whether the patient has received any previous cancer treatment.
    If treatments are present, list them exactly as mentioned (e.g., surgery, chemotherapy, radiation, other) following the provided output patterns.
    
    Always present the output in the following structured format and in English:
    Annotation: Previous cancer treatment: [select one option].
    
    Allowed output options (strictly select one):
    
    Previous cancer treatment: radiation, chemotherapy.
    Previous cancer treatment: radiation, other.
    Previous cancer treatment: radiation, surgery, other.
    Previous cancer treatment: surgery, chemotherapy, radiation, other.
    Previous cancer treatment: surgery, radiation, other.
    Previous cancer treat
        ... [truncated 5852 more characters] ...
    ----------------------------------------------------------------------
✗ Mismatch (sim: 0.00, 15.14s)
  Expected:  [NO EXPECTED ANNOTATION]
  Predicted: Previous cancer treatment: No previous cancer treatments.
    [11/93] occurrence_cancer-int ... 
    Prompt (6862 chars):
    ----------------------------------------------------------------------
    Task:
    You are a clinical information extraction assistant.
    
    From the given medical note, identify if there is any mention or evidence of other (non-index) cancers occurring in the patient — either in the past or concurrently.
    Extract the exact description if available (e.g., “prostate cancer”, “breast cancer”, “gastric adenocarcinoma”).
    If such information is missing, ambiguous, or not mentioned, indicate that explicitly.
    
    Always present the output in the following structured format and in English:
    
    Format:
    Annotation: Occurrence of other cancer [type]: [description].
    
    Allowed output options (strictly select one):
    
    Occurrence of other cancer unknown at initial excision.
    Occurrence of other cancer prostate cancer.
    Occurrence of other cancer sarcoma.
    Occurrence of other cancer breast cancer.
        ... [truncated 6062 more characters] ...
    ----------------------------------------------------------------------
✓ Match (sim: 1.00, 17.48s)
  Expected:  No previous or concurrent cancers
  Predicted: No previous or concurrent cancers.
  Note P001_2018-03-15_consultation_1 completed in 191.56s (avg 17.415s per prompt)

  Processing note: P001_2018-03-22_radiology_2 (radiology)
    Filtered prompts: 3/27 prompts relevant to radiology
    [12/93] tumordiameter-int ... 
    Prompt (5279 chars):
    ----------------------------------------------------------------------
    You are an expert medical annotator specializing in oncology pathology. Your task is to extract extract the tumor longest diameter (in mm) and the date from the provided medical note and output it in a precise, templated format.
    
    Formats:
    Tumor longest diameter: [value]mm (at initial imaging on [date]).
    Tumor longest diameter unknown.
    
    If the date is missing, output [put date].  
    
    ---
    
    Here are few examples for your understanding:
    Example:
    - Medical Note: Paziente maschio, 29 anni, noto per neoformazione a livello del dorso del piede destro di circa 20 mm comparsa da circa 3 settimane (prima valutazione 01/09/2019). In anamnesi recente: ecografia 03/09/2019 e RMN 10/09/2019 che hanno documentato lesione sottocutanea di 20 mm con interessamento focale del muscolo estensore superficiale, bio
        ... [truncated 4479 more characters] ...
    ----------------------------------------------------------------------
✓ Match (sim: 1.00, 15.80s)
  Expected:  Tumor longest diameter: 110 mm (at initial imaging on 22/03/2018)
  Predicted: Tumor longest diameter: 110 mm (at initial imaging on 22/03/2018).
    [13/93] tumordepth-int ... 
    Prompt (5432 chars):
    ----------------------------------------------------------------------
    You are a clinical information extraction assistant specialized in oncology pathology and radiology reports.
    
    Task:
    From the given medical note, determine the tumor depth and output **only one** of the two values: `superficial` or `deep`.
    
    Output format (exact):
    Annotation: Tumor depth: [superficial|deep].
    
    ---
    
    Here are few examples for your understanding:
    Example:
    - Medical Note: Indicazione: massa sottocutanea del dorso del piede destro di circa 20 mm, presente da circa 3 settimane; valutata in ambulatorio il 01/09/2019 e studiata con ecografia (03/09/2019) e RMN (10/09/2019) che hanno documentato lesione sottocutanea con interessamento focale del muscolo estensore superficiale e assenza di invasione ossea evidente. ... che hanno documentato lesione sottocutanea con interessamento focal
        ... [truncated 4632 more characters] ...
    ----------------------------------------------------------------------
✗ Mismatch (sim: 0.78, 14.13s)
  Expected:  Tumor depth: deep (intramuscular)
  Predicted: Tumor depth: deep.
    [14/93] tumorsite-int ... 
    Prompt (7346 chars):
    ----------------------------------------------------------------------
    Task:
    You are a clinical information extraction assistant.
    From the provided medical note, identify the tumor location category and the exact tumor site.
    
    Instructions:
    
    1. Read the note carefully and find the actual tumor site mentioned for the current case, not historical disease, treatment site, or previous surgery.
    
    2. Determine the broader anatomical category that best fits the tumor site (e.g., Upper and Lower limbs, Trunk wall, Intra abdominal, Genito urinary, Head and neck, Breast).
    
    3. Then specify the exact site (e.g., Upper leg, Groin, Thoracic wall, Paravertebral – thoracolumbar, skin of right breast, etc.).
    
    4. When both an organ and a surface or subregion are mentioned, prioritize the most specific surface or subregion (e.g., “skin of right breast” → not Breast).
    
    5. When ter
        ... [truncated 6546 more characters] ...
    ----------------------------------------------------------------------
✓ Match (sim: 0.85, 19.75s)
  Expected:  Tumor site (Upper and Lower limbs): Left thigh (anterior compartment)
  Predicted: Tumor site (Upper and Lower limbs): anterior compartment of left thigh (intramuscular).
  Note P001_2018-03-22_radiology_2 completed in 49.68s (avg 16.562s per prompt)

  Processing note: P001_2018-03-30_pathology_3 (pathology)
    Filtered prompts: 8/27 prompts relevant to pathology
    [15/93] histological-tipo-int ... 
    Prompt (4733 chars):
    ----------------------------------------------------------------------
    Task: You are a clinical information extraction assistant.
    Your task is to carefully read the given medical note and identify the histological type of the tumor.
    
    Always select only one histological type from the controlled list provided below.
    
    If multiple histological types are mentioned, choose the most specific or final diagnosis.
    
    Output strictly in the following format:
    Annotation: Histological type: [selected type] ([ICD-O-3 code]).
    
    ---
    
    Here are few examples for your understanding:
    Example:
    - Medical Note: Anamnesi essenziale: donna, 85 anni, diagnostico istologico di pleomorphic liposarcoma (ICD-O-3 8858/3) FNCLCC grado 3, lesione profonda della parete addominale anteriore diametro max 200 mm. ... Intervento chirurgico di escissione ampia con component separation e ricostruzione 
        ... [truncated 3933 more characters] ...
    ----------------------------------------------------------------------
✗ Mismatch (sim: 0.58, 14.47s)
  Expected:  Histological type: Myxoid liposarcoma (8852/3)
  Predicted: Histological type: Liposarcoma mixoide (ICD-O-3: 8852/3).
    [16/93] biopsygrading-int ... 
    Prompt (4065 chars):
    ----------------------------------------------------------------------
    Task: You are a medical text annotation assistant.
    Your task is to read a given medical note and identify the biopsy grading (FNCLCC) mentioned in the note.
    
    Output strictly in the following format:
    Biopsy grading (FNCLCC): [value].
    
    The values can be from the following options: 1 or  2 or 3 or Other classification system high or Other classification system low or Biopsy grading not applicable or Unknown biopsy grading.
    
    ---
    
    Here are few examples for your understanding:
    Example:
    - Medical Note: Documentazione istologica disponibile: pleomorphic liposarcoma (ICD-O-3 8858/3), FNCLCC grado 3; dimensione massima riportata circa 200 mm.
    - Annotation: Biopsy grading (FNCLCC): Grade 3
    
    Example:
    - Medical Note: Istologia conosciuta: liposarcoma pleomorfo, ICD-O 8858/3, FNCLCC grado 3 (referto ist
        ... [truncated 3265 more characters] ...
    ----------------------------------------------------------------------
✓ Match (sim: 1.00, 10.40s)
  Expected:  Biopsy grading (FNCLCC): Grade 2
  Predicted: Biopsy grading (FNCLCC): Grade 2
    [17/93] biopsymitoticcount-int ... 
    Prompt (3425 chars):
    ----------------------------------------------------------------------
    You are an expert medical annotator specializing in extracting structured clinical information from oncology notes. 
    Identify the biopsy mitotic count from the provided medical note and output it exactly in the following format:
    
    Format:
    Biopsy mitotic count: [value]HPF/mm2.
    (If not explicitly stated or unclear, output: “Unknown biopsy mitotic count.”)
    
    Do not include any explanations, reasoning, extra text, the medical note — only output the annotation value in the specified format above.
    
    ---
    
    Here are few examples for your understanding:
    Example:
    - Medical Note: Documentazione istologica disponibile: pleomorphic liposarcoma (ICD-O-3 8858/3), FNCLCC grado 3; dimensione massima riportata circa 200 mm. ... - Richiesta invio/referto istologico completo in cartella (se non già presente) per 
        ... [truncated 2625 more characters] ...
    ----------------------------------------------------------------------
✗ Mismatch (sim: 0.45, 9.26s)
  Expected:  Unknown biopsy mitotic count
  Predicted: Biopsy mitotic count: moderate HPF/mm2.
    [18/93] necrosis_in_biopsy-int ... 
    Prompt (2853 chars):
    ----------------------------------------------------------------------
    Task: You are an expert medical annotator specializing in oncology pathology. Your task is to extract necrosis information from the provided medical note and output it in a precise, templated format.
    
    Possible Output Formats (use only one):
    Necrosis in biopsy specimen (type of): [percentage value] of tumor.
    Necrosis in biopsy specimen (type of): absent.
    Necrosis in biopsy specimen (type of): none.
    Necrosis in biopsy specimen (type of): present.
    Necrosis in biopsy specimen (type of): unknown.
    
    Do not include explanations, reasoning, or any extra text — only one final annotation line exactly as specified below.
    
    ---
    
    Here are few examples for your understanding:
    Example:
    - Medical Note: Sono presenti aree di necrosi tumorale a focalità variabile. L'architettura è compatibile con un sarcoma p
        ... [truncated 2053 more characters] ...
    ----------------------------------------------------------------------
✗ Mismatch (sim: 0.44, 7.77s)
  Expected:  Necrosis in biopsy core specimen (type of): necrosi non significativa nel campione disponibile
  Predicted: Necrosis in biopsy specimen (type): non significant necrosis present.
    [19/93] tumorbiopsytype-int ... 
    Prompt (4738 chars):
    ----------------------------------------------------------------------
    You are a clinical information extraction assistant.  
    Your task: From the given medical note, extract the biopsy type and the date (if present).  
    If the date is missing, output 'unknown'.  
    If the place is not mentioned, output 'in the hospital'.  
    Always present the output in the following structured format:  
    
    Annotation: Baseline/primary tumor [biopsy type] biopsy has been performed on [date] in [place].
    
    ---
    
    Here are few examples for your understanding:
    Example:
    - Medical Note: Diagnosi preoperatoria: massa profonda della parete addominale anteriore, sospetto pleomorphic liposarcoma (ICD-O-3 8858/3), lesione radiologicamente di circa 200 mm testimoniata da ecografia del 25/04/2022 e RMN del 02/05/2022; stadiazione TC torace-addome-pelvi senza evidenza di metastasi al 05/05/2022. Paz
        ... [truncated 3938 more characters] ...
    ----------------------------------------------------------------------
✓ Match (sim: 0.94, 13.50s)
  Expected:  Baseline/primary tumor core needle (ecoguidata) biopsy has been performed on 30/03/2018 in unknown place
  Predicted: Baseline/primary tumor core needle biopsy has been performed on 30/03/2018 in unknown place
    [20/93] surgical-specimen-grading-int ... 
    Prompt (4837 chars):
    ----------------------------------------------------------------------
    You are a clinical information extraction assistant specialized in oncology.  
    Your task: From the given medical note, extract the **Surgical specimen grading (FNCLCC)** information.
    
    Guidelines:
    1. Identify explicit FNCLCC grades ('1' or '2' or '3' or 'Other classification system high' or 'Other classification system low').
    2. If no FNCLCC grade is mentioned but a grading level is implied using terms like “alto grado”, “basso grado”, or “intermedio”, interpret them as “Other classification system high/low/intermediate”.
    3. If both grading systems appear, prefer the FNCLCC value.
    4. If grading information is missing or uncertain, return nothing.
    5. The output must always follow this structured format:
    
    Annotation: Surgical specimen grading (FNCLCC): [grade or description].
    
    ---
    
    Here are f
        ... [truncated 4037 more characters] ...
    ----------------------------------------------------------------------
✗ Mismatch (sim: 0.00, 13.93s)
  Expected:  [NO EXPECTED ANNOTATION]
  Predicted: Surgical specimen grading (FNCLCC): 2 (intermedio)
    [21/93] surgical-mitotic-count-int ... 
    Prompt (3783 chars):
    ----------------------------------------------------------------------
    You are a clinical information extraction assistant specialized in oncopathology.  
    Your task: From the given medical note, extract the **Surgical specimen mitotic count**.
    
    Guidelines:
    1. The Surgical specimen mitotic count can be easily found in the note where there is a mention of HPF succeeded by a value such as <1/10 HPF or >3/10 HPF or 10/10 HPF, etc. There may be a leading space between the numeric value and sign in some case. Return as it is.
    2. The output must strictly follow this format:
    
    Annotation: Surgical specimen mitotic count: [value].
    
    If the case corresponds to unknown or missing information, use:
    Annotation: Unknown surgical specimen mitotic count.
    
    ---
    
    Here are few examples for your understanding:
    Example:
    - Medical Note: Intervento chirurgico di escissione ampia con c
        ... [truncated 2983 more characters] ...
    ----------------------------------------------------------------------
✗ Mismatch (sim: 0.00, 8.91s)
  Expected:  [NO EXPECTED ANNOTATION]
  Predicted: Surgical specimen mitotic count: unknown
    [22/93] necrosis_in_surgical-int ... 
    Prompt (4036 chars):
    ----------------------------------------------------------------------
    Task: You are an expert medical annotator specializing in oncology pathology. Your task is to extract necrosis information from the provided medical note and output it in a precise, templated format.
    
    Possible Output Formats (use only one):
    Necrosis in surgical specimen (type of): 10%. 
    Necrosis in surgical specimen (type of): absent. 
    Necrosis in surgical specimen (type of): coagulative necrosis. 
    Necrosis in surgical specimen (type of): coagulative. 
    Necrosis in surgical specimen (type of): none. 
    Necrosis in surgical specimen (type of): unknown. 
    
    Do not include explanations, reasoning, or any extra text — only one final annotation line exactly as specified below.
    
    ---
    
    Here are few examples for your understanding:
    Example:
    - Medical Note: Intervento chirurgico di escissione ampia con c
        ... [truncated 3236 more characters] ...
    ----------------------------------------------------------------------
✗ Mismatch (sim: 0.00, 9.88s)
  Expected:  [NO EXPECTED ANNOTATION]
  Predicted: Necrosis in surgical specimen (type): none.
  Note P001_2018-03-30_pathology_3 completed in 88.11s (avg 11.014s per prompt)

  Processing note: P001_2018-04-05_staging_4 (staging)
    Filtered prompts: 1/27 prompts relevant to staging
    [23/93] stage_at_diagnosis-int ... 
    Prompt (7667 chars):
    ----------------------------------------------------------------------
    You are an expert medical annotator specializing in extracting structured clinical information from medical notes. Identify the stage at diagnosis from the provided medical note. 
    The response must be any one of the following answers: 
    
    Possible Answers: 
    Stage at diagnosis: localized. 
    Stage at diagnosis: loco-regional (In transit metastasis). 
    Stage at diagnosis: metastatic (regional nodal metastases). 
    Unknown stage at diagnosis. 
    
    Do not include any explanations, reasoning, extra text, the medical note.
    
    ---
    
    Here are few examples for your understanding:
    Example:
    - Medical Note: Imaging di sorveglianza: TC torace eseguita in prossimità della visita (01/03/2023) non evidenzia lesioni polmonari sospette né segni di malattia a distanza rispetto agli esami basali; confrontabile con staging
        ... [truncated 6867 more characters] ...
    ----------------------------------------------------------------------
✗ Mismatch (sim: 0.56, 21.29s)
  Expected:  Stage at diagnosis (clinical AJCC): Localized (cT2 N0 M0) — clinical stage II (as of 05/04/2018)
  Predicted: Stage at diagnosis (clinical): localized
  Note P001_2018-04-05_staging_4 completed in 21.29s (avg 21.286s per prompt)

  Processing note: P001_2018-05-15_surgery_5 (surgery)
    Filtered prompts: 6/27 prompts relevant to surgery
    [24/93] surgerytype-fs30-int ... 
    Prompt (8661 chars):
    ----------------------------------------------------------------------
    Task: You are a medical text annotation assistant. Given a clinical note, extract structured surgery-related information.
    
    1. If a surgery is described, always return:
       - Whether it was **Primary surgery** or simply **Surgery**.
       - The **date of surgery** in DD/MM/YYYY format.
       - Whether the surgery was **macroscopically complete**, **macroscopically incomplete**, or **[select result]** 
         (if margins or completeness are not explicitly mentioned).
    
    2. If no surgery information exists, return nothing.
    
    Your answer must follow exactly one of these formats:
    - "Primary surgery was performed on DD/MM/YYYY and was macroscopically complete."
    - "Primary surgery was performed on DD/MM/YYYY and was macroscopically incomplete."
    - "Primary surgery was performed on DD/MM/YYYY and was macroscop
        ... [truncated 7861 more characters] ...
    ----------------------------------------------------------------------
✗ Mismatch (sim: 0.00, 23.07s)
  Expected:  [NO EXPECTED ANNOTATION]
  Predicted: Primary surgery was performed on 15/05/2018 and was macroscopically complete.
    [25/93] surgerymargins-int ... 
    Prompt (6706 chars):
    ----------------------------------------------------------------------
    Task: You are a medical text annotation assistant. Your task is to analyze a medical note and classify the surgical resection margin status.
    Always output the result in the following format:
    Margins after surgery: [R0 or R1 or R2]
    
    R0 (radical, tumor-free margins):
    
    Important: A “small but clear” margin = still R0.
    
    Output only the classification in the required format. Do not add explanations.
    
    ---
    
    Here are few examples for your understanding:
    Example:
    - Medical Note: Resezione oncologica intrapresa con intento di margini macroscopici liberi; la lesione è risultata non adherente al peritoneo che è stato risparmiato e non è stata necessaria la breccia peritoneale. ... Etichettato e inviato per esame istologico completo, con richiesta di valutazione margini e gradazione FNCLCC. ... Risulta
        ... [truncated 5906 more characters] ...
    ----------------------------------------------------------------------
✗ Mismatch (sim: 0.26, 18.35s)
  Expected:  Margins after surgery: close (macroscopically close; microscopic margin status pending on definitive histology)
  Predicted: Margins after surgery: R0
    [26/93] reexcision-int ... 
    Prompt (3264 chars):
    ----------------------------------------------------------------------
    You are a clinical information extraction assistant specialized in oncological surgery documentation.
    Your task: From the given medical note, extract re-excision (radicalization) information, including:
    1. The date when the re-excision was performed (if mentioned).
    2. Whether it was macroscopically complete, incomplete, or if such information is unknown.
    
    Formats:
    Re-excision was performed on [provide date] and was macroscopically [complete/incomplete]. 
    
    Notes:
    If the date is missing, output [put date] in the format.
    If the result is missing, output [select result] in the format.
    
    ---
    
    Here are few examples for your understanding:
    Example:
    - Medical Note: Ampia escissione locale eseguita il 10/10/2019 con ricostruzione mediante lembo locale; esame istologico definitivo del 18/10/2019 conf
        ... [truncated 2464 more characters] ...
    ----------------------------------------------------------------------
✗ Mismatch (sim: 0.00, 9.24s)
  Expected:  [NO EXPECTED ANNOTATION]
  Predicted: Re-excision was performed on [15/05/2018] and was macroscopically [unknown].
    [27/93] surgical-specimen-grading-int ... 
    Prompt (7065 chars):
    ----------------------------------------------------------------------
    You are a clinical information extraction assistant specialized in oncology.  
    Your task: From the given medical note, extract the **Surgical specimen grading (FNCLCC)** information.
    
    Guidelines:
    1. Identify explicit FNCLCC grades ('1' or '2' or '3' or 'Other classification system high' or 'Other classification system low').
    2. If no FNCLCC grade is mentioned but a grading level is implied using terms like “alto grado”, “basso grado”, or “intermedio”, interpret them as “Other classification system high/low/intermediate”.
    3. If both grading systems appear, prefer the FNCLCC value.
    4. If grading information is missing or uncertain, return nothing.
    5. The output must always follow this structured format:
    
    Annotation: Surgical specimen grading (FNCLCC): [grade or description].
    
    ---
    
    Here are f
        ... [truncated 6265 more characters] ...
    ----------------------------------------------------------------------
✓ Match (sim: 0.82, 19.09s)
  Expected:  Surgical specimen grading (FNCLCC): unknown
  Predicted: Surgical specimen grading (FNCLCC): 3
    [28/93] surgical-mitotic-count-int ... 
    Prompt (4653 chars):
    ----------------------------------------------------------------------
    You are a clinical information extraction assistant specialized in oncopathology.  
    Your task: From the given medical note, extract the **Surgical specimen mitotic count**.
    
    Guidelines:
    1. The Surgical specimen mitotic count can be easily found in the note where there is a mention of HPF succeeded by a value such as <1/10 HPF or >3/10 HPF or 10/10 HPF, etc. There may be a leading space between the numeric value and sign in some case. Return as it is.
    2. The output must strictly follow this format:
    
    Annotation: Surgical specimen mitotic count: [value].
    
    If the case corresponds to unknown or missing information, use:
    Annotation: Unknown surgical specimen mitotic count.
    
    ---
    
    Here are few examples for your understanding:
    Example:
    - Medical Note: Intervento chirurgico di escissione ampia con c
        ... [truncated 3853 more characters] ...
    ----------------------------------------------------------------------
✗ Mismatch (sim: 0.00, 11.04s)
  Expected:  [NO EXPECTED ANNOTATION]
  Predicted: Unknown surgical specimen mitotic count
    [29/93] necrosis_in_surgical-int ... 
    Prompt (4864 chars):
    ----------------------------------------------------------------------
    Task: You are an expert medical annotator specializing in oncology pathology. Your task is to extract necrosis information from the provided medical note and output it in a precise, templated format.
    
    Possible Output Formats (use only one):
    Necrosis in surgical specimen (type of): 10%. 
    Necrosis in surgical specimen (type of): absent. 
    Necrosis in surgical specimen (type of): coagulative necrosis. 
    Necrosis in surgical specimen (type of): coagulative. 
    Necrosis in surgical specimen (type of): none. 
    Necrosis in surgical specimen (type of): unknown. 
    
    Do not include explanations, reasoning, or any extra text — only one final annotation line exactly as specified below.
    
    ---
    
    Here are few examples for your understanding:
    Example:
    - Medical Note: Intervento chirurgico di escissione ampia con c
        ... [truncated 4064 more characters] ...
    ----------------------------------------------------------------------
✗ Mismatch (sim: 0.00, 11.67s)
  Expected:  [NO EXPECTED ANNOTATION]
  Predicted: Necrosis in surgical specimen (type): absent.
  Note P001_2018-05-15_surgery_5 completed in 92.46s (avg 15.411s per prompt)

  Processing note: P001_2018-05-22_pathology_6 (pathology)
    Filtered prompts: 8/27 prompts relevant to pathology
    [30/93] histological-tipo-int ... 
    Prompt (4267 chars):
    ----------------------------------------------------------------------
    Task: You are a clinical information extraction assistant.
    Your task is to carefully read the given medical note and identify the histological type of the tumor.
    
    Always select only one histological type from the controlled list provided below.
    
    If multiple histological types are mentioned, choose the most specific or final diagnosis.
    
    Output strictly in the following format:
    Annotation: Histological type: [selected type] ([ICD-O-3 code]).
    
    ---
    
    Here are few examples for your understanding:
    Example:
    - Medical Note: Anamnesi essenziale: donna, 85 anni, diagnostico istologico di pleomorphic liposarcoma (ICD-O-3 8858/3) FNCLCC grado 3, lesione profonda della parete addominale anteriore diametro max 200 mm. ... Intervento chirurgico di escissione ampia con component separation e ricostruzione 
        ... [truncated 3467 more characters] ...
    ----------------------------------------------------------------------
✗ Mismatch (sim: 0.71, 12.26s)
  Expected:  Histological type: Myxoid liposarcoma (ICD-O-3 8852/3); round-cell component <5%
  Predicted: Histological type: Myxoid liposarcoma (ICD-O-3: 8852/3).
    [31/93] biopsygrading-int ... 
    Prompt (3811 chars):
    ----------------------------------------------------------------------
    Task: You are a medical text annotation assistant.
    Your task is to read a given medical note and identify the biopsy grading (FNCLCC) mentioned in the note.
    
    Output strictly in the following format:
    Biopsy grading (FNCLCC): [value].
    
    The values can be from the following options: 1 or  2 or 3 or Other classification system high or Other classification system low or Biopsy grading not applicable or Unknown biopsy grading.
    
    ---
    
    Here are few examples for your understanding:
    Example:
    - Medical Note: Istologia conosciuta: liposarcoma pleomorfo, ICD-O 8858/3, FNCLCC grado 3 (referto istologico pregresso/documentazione disponibile in cartella). ... Conclusioni: TC di stadiazione 05/05/2022 senza evidenza di metastasi a distanza (cM0); malattia localizzata di alto grado (pleomorphic liposarcoma G3
        ... [truncated 3011 more characters] ...
    ----------------------------------------------------------------------
✗ Mismatch (sim: 0.00, 10.24s)
  Expected:  [NO EXPECTED ANNOTATION]
  Predicted: Biopsy grading (FNCLCC): Grade 2
    [32/93] biopsymitoticcount-int ... 
    Prompt (3171 chars):
    ----------------------------------------------------------------------
    You are an expert medical annotator specializing in extracting structured clinical information from oncology notes. 
    Identify the biopsy mitotic count from the provided medical note and output it exactly in the following format:
    
    Format:
    Biopsy mitotic count: [value]HPF/mm2.
    (If not explicitly stated or unclear, output: “Unknown biopsy mitotic count.”)
    
    Do not include any explanations, reasoning, extra text, the medical note — only output the annotation value in the specified format above.
    
    ---
    
    Here are few examples for your understanding:
    Example:
    - Medical Note: Documentazione istologica disponibile: pleomorphic liposarcoma (ICD-O-3 8858/3), FNCLCC grado 3; dimensione massima riportata circa 200 mm. ... - Richiesta invio/referto istologico completo in cartella (se non già presente) per 
        ... [truncated 2371 more characters] ...
    ----------------------------------------------------------------------
✗ Mismatch (sim: 0.00, 7.99s)
  Expected:  [NO EXPECTED ANNOTATION]
  Predicted: Biopsy mitotic count: unknown
    [33/93] necrosis_in_biopsy-int ... 
    Prompt (2599 chars):
    ----------------------------------------------------------------------
    Task: You are an expert medical annotator specializing in oncology pathology. Your task is to extract necrosis information from the provided medical note and output it in a precise, templated format.
    
    Possible Output Formats (use only one):
    Necrosis in biopsy specimen (type of): [percentage value] of tumor.
    Necrosis in biopsy specimen (type of): absent.
    Necrosis in biopsy specimen (type of): none.
    Necrosis in biopsy specimen (type of): present.
    Necrosis in biopsy specimen (type of): unknown.
    
    Do not include explanations, reasoning, or any extra text — only one final annotation line exactly as specified below.
    
    ---
    
    Here are few examples for your understanding:
    Example:
    - Medical Note: Sono presenti aree di necrosi tumorale a focalità variabile. L'architettura è compatibile con un sarcoma p
        ... [truncated 1799 more characters] ...
    ----------------------------------------------------------------------
✗ Mismatch (sim: 0.00, 6.49s)
  Expected:  [NO EXPECTED ANNOTATION]
  Predicted: Necrosis in biopsy specimen (type): none.
    [34/93] tumorbiopsytype-int ... 
    Prompt (4484 chars):
    ----------------------------------------------------------------------
    You are a clinical information extraction assistant.  
    Your task: From the given medical note, extract the biopsy type and the date (if present).  
    If the date is missing, output 'unknown'.  
    If the place is not mentioned, output 'in the hospital'.  
    Always present the output in the following structured format:  
    
    Annotation: Baseline/primary tumor [biopsy type] biopsy has been performed on [date] in [place].
    
    ---
    
    Here are few examples for your understanding:
    Example:
    - Medical Note: Diagnosi preoperatoria: massa profonda della parete addominale anteriore, sospetto pleomorphic liposarcoma (ICD-O-3 8858/3), lesione radiologicamente di circa 200 mm testimoniata da ecografia del 25/04/2022 e RMN del 02/05/2022; stadiazione TC torace-addome-pelvi senza evidenza di metastasi al 05/05/2022. Paz
        ... [truncated 3684 more characters] ...
    ----------------------------------------------------------------------
✗ Mismatch (sim: 0.78, 13.09s)
  Expected:  Baseline/primary tumor core needle biopsy has been performed on 30/03/2018 in unknown place
  Predicted: Baseline/primary tumor core needle biopsy has been performed on 15/05/2018 in unknown place
    [35/93] surgical-specimen-grading-int ... 
    Prompt (4861 chars):
    ----------------------------------------------------------------------
    You are a clinical information extraction assistant specialized in oncology.  
    Your task: From the given medical note, extract the **Surgical specimen grading (FNCLCC)** information.
    
    Guidelines:
    1. Identify explicit FNCLCC grades ('1' or '2' or '3' or 'Other classification system high' or 'Other classification system low').
    2. If no FNCLCC grade is mentioned but a grading level is implied using terms like “alto grado”, “basso grado”, or “intermedio”, interpret them as “Other classification system high/low/intermediate”.
    3. If both grading systems appear, prefer the FNCLCC value.
    4. If grading information is missing or uncertain, return nothing.
    5. The output must always follow this structured format:
    
    Annotation: Surgical specimen grading (FNCLCC): [grade or description].
    
    ---
    
    Here are f
        ... [truncated 4061 more characters] ...
    ----------------------------------------------------------------------
✓ Match (sim: 1.00, 13.08s)
  Expected:  Surgical specimen grading (FNCLCC): Grade 2
  Predicted: Surgical specimen grading (FNCLCC): Grade 2
    [36/93] surgical-mitotic-count-int ... 
    Prompt (3661 chars):
    ----------------------------------------------------------------------
    You are a clinical information extraction assistant specialized in oncopathology.  
    Your task: From the given medical note, extract the **Surgical specimen mitotic count**.
    
    Guidelines:
    1. The Surgical specimen mitotic count can be easily found in the note where there is a mention of HPF succeeded by a value such as <1/10 HPF or >3/10 HPF or 10/10 HPF, etc. There may be a leading space between the numeric value and sign in some case. Return as it is.
    2. The output must strictly follow this format:
    
    Annotation: Surgical specimen mitotic count: [value].
    
    If the case corresponds to unknown or missing information, use:
    Annotation: Unknown surgical specimen mitotic count.
    
    ---
    
    Here are few examples for your understanding:
    Example:
    - Medical Note: Intervento chirurgico di escissione ampia con c
        ... [truncated 2861 more characters] ...
    ----------------------------------------------------------------------
✗ Mismatch (sim: 0.00, 8.97s)
  Expected:  [NO EXPECTED ANNOTATION]
  Predicted: Surgical specimen mitotic count: unknown
    [37/93] necrosis_in_surgical-int ... 
    Prompt (3777 chars):
    ----------------------------------------------------------------------
    Task: You are an expert medical annotator specializing in oncology pathology. Your task is to extract necrosis information from the provided medical note and output it in a precise, templated format.
    
    Possible Output Formats (use only one):
    Necrosis in surgical specimen (type of): 10%. 
    Necrosis in surgical specimen (type of): absent. 
    Necrosis in surgical specimen (type of): coagulative necrosis. 
    Necrosis in surgical specimen (type of): coagulative. 
    Necrosis in surgical specimen (type of): none. 
    Necrosis in surgical specimen (type of): unknown. 
    
    Do not include explanations, reasoning, or any extra text — only one final annotation line exactly as specified below.
    
    ---
    
    Here are few examples for your understanding:
    Example:
    - Medical Note: Referto istopatologico definitivo del 20/06/202
        ... [truncated 2977 more characters] ...
    ----------------------------------------------------------------------
✗ Mismatch (sim: 0.00, 9.63s)
  Expected:  [NO EXPECTED ANNOTATION]
  Predicted: Necrosis in surgical specimen (type): none.
  Note P001_2018-05-22_pathology_6 completed in 81.76s (avg 10.220s per prompt)

  Processing note: P001_2018-06-15_oncology_7 (oncology)
    Filtered prompts: 6/27 prompts relevant to oncology
    [38/93] chemotherapy_start-int ... 
    Prompt (6797 chars):
    ----------------------------------------------------------------------
    Task: You are an expert medical annotator specializing in oncology pathology. Your task is to extract extract chemotherapy details from the provided medical note and output it in a precise, templated format.
    
    Formats:
    pre-operative chemotherapy with [select intent] started on [provide date] and utilized [select regimen] regimen.
    post-operative chemotherapy with [select intent] started on [provide date] and utilized [select regimen] regimen.
    
    Notes:
    If the date is missing, output [provide date].
    If the regimen is missing, output [select regimen].
    If the intent is missing, output [select intent].
    
    ---
    
    Here are few examples for your understanding:
    Example:
    - Medical Note: Referto TC torace eseguita il 10/06/2024 per valutazione di risposta a terapia sistemica (pleomorphic liposarcoma, tratta
        ... [truncated 5997 more characters] ...
    ----------------------------------------------------------------------
✗ Mismatch (sim: 0.00, 19.93s)
  Expected:  [NO EXPECTED ANNOTATION]
  Predicted: pre-operative chemotherapy with [select intent] started on [provide date] and utilized [select regimen] regimen.
    [39/93] chemotherapy_end-int ... 
    Prompt (5648 chars):
    ----------------------------------------------------------------------
    Task: You are an expert medical annotator specializing in oncology pathology. Your task is to extract extract chemotherapy details from the provided medical note and output it in a precise, templated format.
    
    Formats:
    pre-operative chemotherapy ended on [provide date] after [provide number] of cycles because of [select reason]
    post-operative chemotherapy ended on [provide date] after [provide number] of cycles because of [select reason]
    
    Notes:
    If the date is missing, output [provide date].
    If the reason is missing, output [select reason].
    If the number of cycles is missing, output [provide number].
    
    ---
    
    Here are few examples for your understanding:
    Example:
    - Medical Note: chemioterapia adiuvante VDC/IE completata 15/07/2020 e radioterapia al letto tumorale 54 Gy/27 fx iniziata 01/08/202
        ... [truncated 4848 more characters] ...
    ----------------------------------------------------------------------
✗ Mismatch (sim: 0.00, 14.91s)
  Expected:  [NO EXPECTED ANNOTATION]
  Predicted: Adjuvant chemotherapy ended on [provide date] after unknown number of cycles because of completion of planned treatment.
    [40/93] radiotherapy_start-int ... 
    Prompt (5909 chars):
    ----------------------------------------------------------------------
    Task: You are an expert medical annotator specializing in oncology pathology. Your task is to extract extract radiotherapy details from the provided medical note and output it in a precise, templated format.
    
    Formats:
    pre-operative radiotherapy (conventional) with [select intention] intention started [please select where] on [put date]. 
    post-operative radiotherapy (conventional) with [select intention] intention started [please select where] on [put date]. 
    
    Notes:
    If the date is missing, output [put date].
    If the place is missing, output [please select where].
    If the intention is missing, output [select intention].
    
    ---
    
    Here are few examples for your understanding:
    Example:
    - Medical Note: Terapia in corso: avviata oggi, 01/08/2022, radioterapia esterna adiuvante sul letto tumorale con 
        ... [truncated 5109 more characters] ...
    ----------------------------------------------------------------------
✗ Mismatch (sim: 0.60, 18.76s)
  Expected:  External-beam radiotherapy (external) with adjuvant intention started at left thigh surgical bed on 15/06/2018 (planned total dose 50 Gy in 25 fractio...
  Predicted: External beam radiotherapy (conformal techniques) with adjuvant intention started at tumor bed on 15/06/2018 (planned/recorded dose 50 Gy in 25 fracti...
    [41/93] radiotherapy_end-int ... 
    Prompt (5515 chars):
    ----------------------------------------------------------------------
    Task: You are an expert medical annotator specializing in oncology pathology. Your task is to extract extract radiotherapy details from the provided medical note and output it in a precise, templated format.
    
    Formats:
    pre-operative radiotherapy in total of [put total dose]Gy in [put number of] fractions ended on [put date] because of [select reason].
    post-operative radiotherapy in total of [put total dose]Gy in [put number of] fractions ended on [put date] because of [select reason].
    
    Notes:
    If the date is missing, output [put date].
    If the reason is missing, output [select reason].
    If the dose is missing, output [put total dose].
    If the number is missing, output [put number of].
    
    ---
    
    Here are few examples for your understanding:
    Example:
    - Medical Note: A seguito di valutazione multidisc
        ... [truncated 4715 more characters] ...
    ----------------------------------------------------------------------
✗ Mismatch (sim: 0.00, 21.05s)
  Expected:  [NO EXPECTED ANNOTATION]
  Predicted: pre-operative radiotherapy in total of 50 Gy in 25 fractions ended on 15/09/2022 because of [select reason].
    [42/93] response-to-int ... 
    Prompt (6245 chars):
    ----------------------------------------------------------------------
    You are a clinical information extraction assistant specialized in oncology.  
    Your task: From the given medical note, identify and extract the **response to therapeutic treatment** (such as chemotherapy or radiotherapy) when no surgical procedure is performed.  
    
    Your goal is to:
    1. Detect the type of therapy mentioned (e.g., therapeutic (without surgery), therapeutic (radiotherapy without surgery), pre-operative, post-operative).
    2. Determine the disease response described (e.g., complete response, partial response, stable disease, progression).
    3. If the response type or therapy type is missing, leave it as “[select type]” or “[select response]”.
    4. Only output one concise, structured annotation per note.
    
    Always format your output strictly as one of the following:
    
    1. Response to [sele
        ... [truncated 5445 more characters] ...
    ----------------------------------------------------------------------
✗ Mismatch (sim: 0.00, 14.82s)
  Expected:  [NO EXPECTED ANNOTATION]
  Predicted: Response to adjuvant radiotherapy was: [select response]
    [43/93] patient-status-int ... 
    Prompt (7720 chars):
    ----------------------------------------------------------------------
    Task: From the given medical note, extract the status of the patient at last follow-up.
    
    Always output in exactly one of the following structured templates:
    
    1. Status of the patient at last follow-up: Alive, No Evidence of Disease (NED)
    2. Status of the patient at last follow-up: Alive With Disease (AWD) - metastases ([please select sites])
    3. Status of the patient at last follow-up: Alive With Disease (AWD) - localised tumor
    4. Status of the patient at last follow-up: Alive With Disease (AWD) - metastases (lung).
    5. Status of the patient at last follow-up: Alive With Disease (AWD) - metastases (lung. other).
    6. Status of the patient at last follow-up: Alive With Disease (AWD) - metastases (lung. soft tissue. other).
    8. Status of the patient at last follow-up: Alive With Disease (AWD) - l
        ... [truncated 6920 more characters] ...
    ----------------------------------------------------------------------
✗ Mismatch (sim: 0.00, 21.69s)
  Expected:  [NO EXPECTED ANNOTATION]
  Predicted: Status of the patient at last follow-up: Alive With Disease (AWD) - localised tumor.
  Note P001_2018-06-15_oncology_7 completed in 111.15s (avg 18.525s per prompt)

  Processing note: P001_2018-07-23_oncology_8 (oncology)
    Filtered prompts: 6/27 prompts relevant to oncology
    [44/93] chemotherapy_start-int ... 
    Prompt (6216 chars):
    ----------------------------------------------------------------------
    Task: You are an expert medical annotator specializing in oncology pathology. Your task is to extract extract chemotherapy details from the provided medical note and output it in a precise, templated format.
    
    Formats:
    pre-operative chemotherapy with [select intent] started on [provide date] and utilized [select regimen] regimen.
    post-operative chemotherapy with [select intent] started on [provide date] and utilized [select regimen] regimen.
    
    Notes:
    If the date is missing, output [provide date].
    If the regimen is missing, output [select regimen].
    If the intent is missing, output [select intent].
    
    ---
    
    Here are few examples for your understanding:
    Example:
    - Medical Note: Referto TC torace eseguita il 10/06/2024 per valutazione di risposta a terapia sistemica (pleomorphic liposarcoma, tratta
        ... [truncated 5416 more characters] ...
    ----------------------------------------------------------------------
✗ Mismatch (sim: 0.00, 24.19s)
  Expected:  [NO EXPECTED ANNOTATION]
  Predicted: pre-operative chemotherapy with [select intent] started on [provide date] and utilized [select regimen] regimen.
    [45/93] chemotherapy_end-int ... 
    Prompt (5071 chars):
    ----------------------------------------------------------------------
    Task: You are an expert medical annotator specializing in oncology pathology. Your task is to extract extract chemotherapy details from the provided medical note and output it in a precise, templated format.
    
    Formats:
    pre-operative chemotherapy ended on [provide date] after [provide number] of cycles because of [select reason]
    post-operative chemotherapy ended on [provide date] after [provide number] of cycles because of [select reason]
    
    Notes:
    If the date is missing, output [provide date].
    If the reason is missing, output [select reason].
    If the number of cycles is missing, output [provide number].
    
    ---
    
    Here are few examples for your understanding:
    Example:
    - Medical Note: chemioterapia adiuvante VDC/IE completata 15/07/2020 e radioterapia al letto tumorale 54 Gy/27 fx iniziata 01/08/202
        ... [truncated 4271 more characters] ...
    ----------------------------------------------------------------------
✗ Mismatch (sim: 0.00, 16.74s)
  Expected:  [NO EXPECTED ANNOTATION]
  Predicted: Adjuvant chemotherapy ended on [provide date] after unknown number of cycles because of completion of planned treatment.
    [46/93] radiotherapy_start-int ... 
    Prompt (5317 chars):
    ----------------------------------------------------------------------
    Task: You are an expert medical annotator specializing in oncology pathology. Your task is to extract extract radiotherapy details from the provided medical note and output it in a precise, templated format.
    
    Formats:
    pre-operative radiotherapy (conventional) with [select intention] intention started [please select where] on [put date]. 
    post-operative radiotherapy (conventional) with [select intention] intention started [please select where] on [put date]. 
    
    Notes:
    If the date is missing, output [put date].
    If the place is missing, output [please select where].
    If the intention is missing, output [select intention].
    
    ---
    
    Here are few examples for your understanding:
    Example:
    - Medical Note: Terapia in corso: avviata oggi, 01/08/2022, radioterapia esterna adiuvante sul letto tumorale con 
        ... [truncated 4517 more characters] ...
    ----------------------------------------------------------------------
✗ Mismatch (sim: 0.70, 14.93s)
  Expected:  external beam radiotherapy (EBRT) with adjuvant intention started on 2018-06-15
  Predicted: External beam radiotherapy (tumor bed, left thigh) with adjuvant intention started on 15/06/2018
    [47/93] radiotherapy_end-int ... 
    Prompt (5396 chars):
    ----------------------------------------------------------------------
    Task: You are an expert medical annotator specializing in oncology pathology. Your task is to extract extract radiotherapy details from the provided medical note and output it in a precise, templated format.
    
    Formats:
    pre-operative radiotherapy in total of [put total dose]Gy in [put number of] fractions ended on [put date] because of [select reason].
    post-operative radiotherapy in total of [put total dose]Gy in [put number of] fractions ended on [put date] because of [select reason].
    
    Notes:
    If the date is missing, output [put date].
    If the reason is missing, output [select reason].
    If the dose is missing, output [put total dose].
    If the number is missing, output [put number of].
    
    ---
    
    Here are few examples for your understanding:
    Example:
    - Medical Note: Per tale motivo è stata eseguita r
        ... [truncated 4596 more characters] ...
    ----------------------------------------------------------------------
✓ Match (sim: 0.83, 14.45s)
  Expected:  external beam radiotherapy in total of 50 Gy in 25 fractions ended on 2018-07-23
  Predicted: Adjuvant external beam radiotherapy in total of 50 Gy in 25 fractions ended on 23/07/2018 because of completed treatment
    [48/93] response-to-int ... 
    Prompt (5653 chars):
    ----------------------------------------------------------------------
    You are a clinical information extraction assistant specialized in oncology.  
    Your task: From the given medical note, identify and extract the **response to therapeutic treatment** (such as chemotherapy or radiotherapy) when no surgical procedure is performed.  
    
    Your goal is to:
    1. Detect the type of therapy mentioned (e.g., therapeutic (without surgery), therapeutic (radiotherapy without surgery), pre-operative, post-operative).
    2. Determine the disease response described (e.g., complete response, partial response, stable disease, progression).
    3. If the response type or therapy type is missing, leave it as “[select type]” or “[select response]”.
    4. Only output one concise, structured annotation per note.
    
    Always format your output strictly as one of the following:
    
    1. Response to [sele
        ... [truncated 4853 more characters] ...
    ----------------------------------------------------------------------
✗ Mismatch (sim: 0.00, 14.59s)
  Expected:  [NO EXPECTED ANNOTATION]
  Predicted: Response to radiotherapy was: No disease response or progression mentioned, but rather completion of treatment with good tolerance.
    [49/93] patient-status-int ... 
    Prompt (7007 chars):
    ----------------------------------------------------------------------
    Task: From the given medical note, extract the status of the patient at last follow-up.
    
    Always output in exactly one of the following structured templates:
    
    1. Status of the patient at last follow-up: Alive, No Evidence of Disease (NED)
    2. Status of the patient at last follow-up: Alive With Disease (AWD) - metastases ([please select sites])
    3. Status of the patient at last follow-up: Alive With Disease (AWD) - localised tumor
    4. Status of the patient at last follow-up: Alive With Disease (AWD) - metastases (lung).
    5. Status of the patient at last follow-up: Alive With Disease (AWD) - metastases (lung. other).
    6. Status of the patient at last follow-up: Alive With Disease (AWD) - metastases (lung. soft tissue. other).
    8. Status of the patient at last follow-up: Alive With Disease (AWD) - l
        ... [truncated 6207 more characters] ...
    ----------------------------------------------------------------------
✗ Mismatch (sim: 0.60, 18.15s)
  Expected:  Status of the patient at last follow-up: Alive, No Evidence of Disease (NED)
  Predicted: Status of the patient at last follow-up: Alive With Disease (AWD) - localised tumor.
  Note P001_2018-07-23_oncology_8 completed in 103.05s (avg 17.175s per prompt)

  Processing note: P001_2019-01-10_follow-up_9 (follow-up)
    Filtered prompts: 3/27 prompts relevant to follow-up
    [50/93] patient-status-int ... 
    Prompt (7323 chars):
    ----------------------------------------------------------------------
    Task: From the given medical note, extract the status of the patient at last follow-up.
    
    Always output in exactly one of the following structured templates:
    
    1. Status of the patient at last follow-up: Alive, No Evidence of Disease (NED)
    2. Status of the patient at last follow-up: Alive With Disease (AWD) - metastases ([please select sites])
    3. Status of the patient at last follow-up: Alive With Disease (AWD) - localised tumor
    4. Status of the patient at last follow-up: Alive With Disease (AWD) - metastases (lung).
    5. Status of the patient at last follow-up: Alive With Disease (AWD) - metastases (lung. other).
    6. Status of the patient at last follow-up: Alive With Disease (AWD) - metastases (lung. soft tissue. other).
    8. Status of the patient at last follow-up: Alive With Disease (AWD) - l
        ... [truncated 6523 more characters] ...
    ----------------------------------------------------------------------
✓ Match (sim: 1.00, 16.61s)
  Expected:  Status of the patient at last follow-up: Alive, No Evidence of Disease (NED)
  Predicted: Status of the patient at last follow-up: Alive, No Evidence of Disease (NED)
    [51/93] recur_or_prog-int ... 
    Prompt (6359 chars):
    ----------------------------------------------------------------------
    Task: You are a medical text annotation assistant. Your task is to determine if the note indicates progression, recurrence, no progression, or no recurrence of the disease. If progression or recurrence is mentioned, also extract the date if available.
    
    Follow these rules:
    
    If the note clearly states no progression or no recurrence, output:
    "There was no progression/recurrence."
    
    If the note mentions recurrence, output:
    "There was a recurrence on [date]." (If a date is mentioned, include it. If no date is mentioned, keep [put date]).
    
    If the note mentions progression, output:
    "There was a progression on [date]." (If a date is mentioned, include it. If no date is mentioned, keep [put date]).
    
    Never add extra explanation. Only output the standardized annotation.
    
    ---
    
    Here are few examples fo
        ... [truncated 5559 more characters] ...
    ----------------------------------------------------------------------
✓ Match (sim: 1.00, 15.89s)
  Expected:  There was no progression/recurrence
  Predicted: There was no progression/recurrence.
    [52/93] recurrencetype-int ... 
    Prompt (8348 chars):
    ----------------------------------------------------------------------
    Task: You are a clinical information extraction assistant.
    Your task is to extract information regarding the type of recurrence or progression of the disease. Use only the templates listed below and strictly adhere to the structure. If multiple metastatic sites are mentioned, list them in the template exactly as they appear. If no relevant information is present, return "None".
    
    Output strictly in the following format:
    Annotation: Type of recurrence/progression: [selected type] .
    
    Possible Output Templates:
    Type of recurrence/progression: local.
    Type of recurrence/progression: local [select site if metastatic].
    Type of recurrence/progression: metastatic.
    Type of recurrence/progression: metastatic bone, soft tissue.
    Type of recurrence/progression: metastatic bone.
    Type of recurrence/progres
        ... [truncated 7548 more characters] ...
    ----------------------------------------------------------------------
✗ Mismatch (sim: 0.00, 20.16s)
  Expected:  [NO EXPECTED ANNOTATION]
  Predicted: Type of recurrence/progression: None.
  Note P001_2019-01-10_follow-up_9 completed in 52.66s (avg 17.554s per prompt)

  Processing note: P001_2020-01-15_follow-up_10 (follow-up)
    Filtered prompts: 3/27 prompts relevant to follow-up
    [53/93] patient-status-int ... 
    Prompt (7272 chars):
    ----------------------------------------------------------------------
    Task: From the given medical note, extract the status of the patient at last follow-up.
    
    Always output in exactly one of the following structured templates:
    
    1. Status of the patient at last follow-up: Alive, No Evidence of Disease (NED)
    2. Status of the patient at last follow-up: Alive With Disease (AWD) - metastases ([please select sites])
    3. Status of the patient at last follow-up: Alive With Disease (AWD) - localised tumor
    4. Status of the patient at last follow-up: Alive With Disease (AWD) - metastases (lung).
    5. Status of the patient at last follow-up: Alive With Disease (AWD) - metastases (lung. other).
    6. Status of the patient at last follow-up: Alive With Disease (AWD) - metastases (lung. soft tissue. other).
    8. Status of the patient at last follow-up: Alive With Disease (AWD) - l
        ... [truncated 6472 more characters] ...
    ----------------------------------------------------------------------
✓ Match (sim: 1.00, 20.35s)
  Expected:  Status of the patient at last follow-up: Alive, No Evidence of Disease (NED)
  Predicted: Status of the patient at last follow-up: Alive, No Evidence of Disease (NED)
    [54/93] recur_or_prog-int ... 
    Prompt (5665 chars):
    ----------------------------------------------------------------------
    Task: You are a medical text annotation assistant. Your task is to determine if the note indicates progression, recurrence, no progression, or no recurrence of the disease. If progression or recurrence is mentioned, also extract the date if available.
    
    Follow these rules:
    
    If the note clearly states no progression or no recurrence, output:
    "There was no progression/recurrence."
    
    If the note mentions recurrence, output:
    "There was a recurrence on [date]." (If a date is mentioned, include it. If no date is mentioned, keep [put date]).
    
    If the note mentions progression, output:
    "There was a progression on [date]." (If a date is mentioned, include it. If no date is mentioned, keep [put date]).
    
    Never add extra explanation. Only output the standardized annotation.
    
    ---
    
    Here are few examples fo
        ... [truncated 4865 more characters] ...
    ----------------------------------------------------------------------
✓ Match (sim: 1.00, 13.14s)
  Expected:  There was no progression/recurrence
  Predicted: There was no progression/recurrence.
    [55/93] recurrencetype-int ... 
    Prompt (7620 chars):
    ----------------------------------------------------------------------
    Task: You are a clinical information extraction assistant.
    Your task is to extract information regarding the type of recurrence or progression of the disease. Use only the templates listed below and strictly adhere to the structure. If multiple metastatic sites are mentioned, list them in the template exactly as they appear. If no relevant information is present, return "None".
    
    Output strictly in the following format:
    Annotation: Type of recurrence/progression: [selected type] .
    
    Possible Output Templates:
    Type of recurrence/progression: local.
    Type of recurrence/progression: local [select site if metastatic].
    Type of recurrence/progression: metastatic.
    Type of recurrence/progression: metastatic bone, soft tissue.
    Type of recurrence/progression: metastatic bone.
    Type of recurrence/progres
        ... [truncated 6820 more characters] ...
    ----------------------------------------------------------------------
✗ Mismatch (sim: 0.00, 18.17s)
  Expected:  [NO EXPECTED ANNOTATION]
  Predicted: Type of recurrence/progression: None.
  Note P001_2020-01-15_follow-up_10 completed in 51.66s (avg 17.219s per prompt)

  Processing note: P001_2021-01-20_follow-up_11 (follow-up)
    Filtered prompts: 3/27 prompts relevant to follow-up
    [56/93] patient-status-int ... 
    Prompt (7511 chars):
    ----------------------------------------------------------------------
    Task: From the given medical note, extract the status of the patient at last follow-up.
    
    Always output in exactly one of the following structured templates:
    
    1. Status of the patient at last follow-up: Alive, No Evidence of Disease (NED)
    2. Status of the patient at last follow-up: Alive With Disease (AWD) - metastases ([please select sites])
    3. Status of the patient at last follow-up: Alive With Disease (AWD) - localised tumor
    4. Status of the patient at last follow-up: Alive With Disease (AWD) - metastases (lung).
    5. Status of the patient at last follow-up: Alive With Disease (AWD) - metastases (lung. other).
    6. Status of the patient at last follow-up: Alive With Disease (AWD) - metastases (lung. soft tissue. other).
    8. Status of the patient at last follow-up: Alive With Disease (AWD) - l
        ... [truncated 6711 more characters] ...
    ----------------------------------------------------------------------
✓ Match (sim: 1.00, 20.58s)
  Expected:  Status of the patient at last follow-up: Alive, No Evidence of Disease (NED)
  Predicted: Status of the patient at last follow-up: Alive, No Evidence of Disease (NED)
    [57/93] recur_or_prog-int ... 
    Prompt (5904 chars):
    ----------------------------------------------------------------------
    Task: You are a medical text annotation assistant. Your task is to determine if the note indicates progression, recurrence, no progression, or no recurrence of the disease. If progression or recurrence is mentioned, also extract the date if available.
    
    Follow these rules:
    
    If the note clearly states no progression or no recurrence, output:
    "There was no progression/recurrence."
    
    If the note mentions recurrence, output:
    "There was a recurrence on [date]." (If a date is mentioned, include it. If no date is mentioned, keep [put date]).
    
    If the note mentions progression, output:
    "There was a progression on [date]." (If a date is mentioned, include it. If no date is mentioned, keep [put date]).
    
    Never add extra explanation. Only output the standardized annotation.
    
    ---
    
    Here are few examples fo
        ... [truncated 5104 more characters] ...
    ----------------------------------------------------------------------
✓ Match (sim: 1.00, 14.94s)
  Expected:  There was no progression/recurrence
  Predicted: There was no progression/recurrence.
    [58/93] recurrencetype-int ... 
    Prompt (8461 chars):
    ----------------------------------------------------------------------
    Task: You are a clinical information extraction assistant.
    Your task is to extract information regarding the type of recurrence or progression of the disease. Use only the templates listed below and strictly adhere to the structure. If multiple metastatic sites are mentioned, list them in the template exactly as they appear. If no relevant information is present, return "None".
    
    Output strictly in the following format:
    Annotation: Type of recurrence/progression: [selected type] .
    
    Possible Output Templates:
    Type of recurrence/progression: local.
    Type of recurrence/progression: local [select site if metastatic].
    Type of recurrence/progression: metastatic.
    Type of recurrence/progression: metastatic bone, soft tissue.
    Type of recurrence/progression: metastatic bone.
    Type of recurrence/progres
        ... [truncated 7661 more characters] ...
    ----------------------------------------------------------------------
✗ Mismatch (sim: 0.00, 21.59s)
  Expected:  [NO EXPECTED ANNOTATION]
  Predicted: Type of recurrence/progression: None.
  Note P001_2021-01-20_follow-up_11 completed in 57.11s (avg 19.035s per prompt)

  Processing note: P001_2022-09-01_radiology_12 (radiology)
    Filtered prompts: 3/27 prompts relevant to radiology
    [59/93] tumordiameter-int ... 
    Prompt (7238 chars):
    ----------------------------------------------------------------------
    You are an expert medical annotator specializing in oncology pathology. Your task is to extract extract the tumor longest diameter (in mm) and the date from the provided medical note and output it in a precise, templated format.
    
    Formats:
    Tumor longest diameter: [value]mm (at initial imaging on [date]).
    Tumor longest diameter unknown.
    
    If the date is missing, output [put date].  
    
    ---
    
    Here are few examples for your understanding:
    Example:
    - Medical Note: Referto TC torace — 20/09/2022
    
    Tecnica: TC torace eseguita il 20/09/2022 con acquisizioni ad alta risoluzione per studio nodulare polmonare.
    
    Risultati: si evidenziano due noduli polmonari di nuova insorgenza rispetto agli esami precedenti. Nel lobo inferiore destro, segmento basale, nodulo solido di 8 mm di diametro massimo; nel lobo su
        ... [truncated 6438 more characters] ...
    ----------------------------------------------------------------------
✗ Mismatch (sim: 0.54, 21.52s)
  Expected:  Tumor longest diameter: 110 mm (at initial imaging on 03/2018)
  Predicted: Tumor longest diameter: 15 mm (at initial imaging on 01/09/2022).
    [60/93] tumordepth-int ... 
    Prompt (4159 chars):
    ----------------------------------------------------------------------
    You are a clinical information extraction assistant specialized in oncology pathology and radiology reports.
    
    Task:
    From the given medical note, determine the tumor depth and output **only one** of the two values: `superficial` or `deep`.
    
    Output format (exact):
    Annotation: Tumor depth: [superficial|deep].
    
    ---
    
    Here are few examples for your understanding:
    Example:
    - Medical Note: Paziente F, 85 anni, nota per lesione profonda della parete addominale anteriore trattata con escissione ampia e ricostruzione il 10/06/2022; istologia definitiva (20/06/2022) ha confermato pleomorphic liposarcoma (ICD-O-3 8858/3), FNCLCC grado 3, dimensione massima 200 mm, margine profondo positivo (R1). ... margine profondo positivo (R1). Stadiazione preoperatoria con TC torace-addome e RMN in maggio 2022 non 
        ... [truncated 3359 more characters] ...
    ----------------------------------------------------------------------
✓ Match (sim: 1.00, 10.94s)
  Expected:  Tumor depth: deep
  Predicted: Tumor depth: deep.
    [61/93] tumorsite-int ... 
    Prompt (8440 chars):
    ----------------------------------------------------------------------
    Task:
    You are a clinical information extraction assistant.
    From the provided medical note, identify the tumor location category and the exact tumor site.
    
    Instructions:
    
    1. Read the note carefully and find the actual tumor site mentioned for the current case, not historical disease, treatment site, or previous surgery.
    
    2. Determine the broader anatomical category that best fits the tumor site (e.g., Upper and Lower limbs, Trunk wall, Intra abdominal, Genito urinary, Head and neck, Breast).
    
    3. Then specify the exact site (e.g., Upper leg, Groin, Thoracic wall, Paravertebral – thoracolumbar, skin of right breast, etc.).
    
    4. When both an organ and a surface or subregion are mentioned, prioritize the most specific surface or subregion (e.g., “skin of right breast” → not Breast).
    
    5. When ter
        ... [truncated 7640 more characters] ...
    ----------------------------------------------------------------------
✓ Match (sim: 0.82, 22.97s)
  Expected:  Tumor site (Upper and Lower limbs): Left thigh (anterior compartment)
  Predicted: Tumor site (Upper and Lower limbs): Left thigh.
  Note P001_2022-09-01_radiology_12 completed in 55.43s (avg 18.476s per prompt)

  Processing note: P001_2022-09-15_pathology_13 (pathology)
    Filtered prompts: 8/27 prompts relevant to pathology
    [62/93] histological-tipo-int ... 
    Prompt (4958 chars):
    ----------------------------------------------------------------------
    Task: You are a clinical information extraction assistant.
    Your task is to carefully read the given medical note and identify the histological type of the tumor.
    
    Always select only one histological type from the controlled list provided below.
    
    If multiple histological types are mentioned, choose the most specific or final diagnosis.
    
    Output strictly in the following format:
    Annotation: Histological type: [selected type] ([ICD-O-3 code]).
    
    ---
    
    Here are few examples for your understanding:
    Example:
    - Medical Note: Esame microscopico: lesione altamente cellulare composta da popolazioni cellulari pleomorfe, con cellule fusate e rotonde, numerose cellule con aspetto lipoblastico, pleomorfismo nucleare marcato e indice mitotico elevato. Sono presenti aree di necrosi tumorale a focalità variab
        ... [truncated 4158 more characters] ...
    ----------------------------------------------------------------------
✓ Match (sim: 1.00, 14.17s)
  Expected:  Histological type: Myxoid liposarcoma (ICD-O-3 8852/3)
  Predicted: Histological type: Myxoid liposarcoma (ICD-O-3: 8852/3).
    [63/93] biopsygrading-int ... 
    Prompt (4408 chars):
    ----------------------------------------------------------------------
    Task: You are a medical text annotation assistant.
    Your task is to read a given medical note and identify the biopsy grading (FNCLCC) mentioned in the note.
    
    Output strictly in the following format:
    Biopsy grading (FNCLCC): [value].
    
    The values can be from the following options: 1 or  2 or 3 or Other classification system high or Other classification system low or Biopsy grading not applicable or Unknown biopsy grading.
    
    ---
    
    Here are few examples for your understanding:
    Example:
    - Medical Note: Documentazione istologica disponibile: pleomorphic liposarcoma (ICD-O-3 8858/3), FNCLCC grado 3; dimensione massima riportata circa 200 mm.
    - Annotation: Biopsy grading (FNCLCC): Grade 3
    
    Example:
    - Medical Note: Istologia conosciuta: liposarcoma pleomorfo, ICD-O 8858/3, FNCLCC grado 3 (referto ist
        ... [truncated 3608 more characters] ...
    ----------------------------------------------------------------------
✗ Mismatch (sim: 0.78, 11.39s)
  Expected:  Biopsy grading (FNCLCC): 2
  Predicted: Biopsy grading (FNCLCC): Grade 2
    [64/93] biopsymitoticcount-int ... 
    Prompt (3768 chars):
    ----------------------------------------------------------------------
    You are an expert medical annotator specializing in extracting structured clinical information from oncology notes. 
    Identify the biopsy mitotic count from the provided medical note and output it exactly in the following format:
    
    Format:
    Biopsy mitotic count: [value]HPF/mm2.
    (If not explicitly stated or unclear, output: “Unknown biopsy mitotic count.”)
    
    Do not include any explanations, reasoning, extra text, the medical note — only output the annotation value in the specified format above.
    
    ---
    
    Here are few examples for your understanding:
    Example:
    - Medical Note: Documentazione istologica disponibile: pleomorphic liposarcoma (ICD-O-3 8858/3), FNCLCC grado 3; dimensione massima riportata circa 200 mm. ... - Richiesta invio/referto istologico completo in cartella (se non già presente) per 
        ... [truncated 2968 more characters] ...
    ----------------------------------------------------------------------
✓ Match (sim: 0.97, 8.74s)
  Expected:  Biopsy mitotic count: Unknown biopsy mitotic count
  Predicted: Biopsy mitotic count: unknown.
    [65/93] necrosis_in_biopsy-int ... 
    Prompt (3196 chars):
    ----------------------------------------------------------------------
    Task: You are an expert medical annotator specializing in oncology pathology. Your task is to extract necrosis information from the provided medical note and output it in a precise, templated format.
    
    Possible Output Formats (use only one):
    Necrosis in biopsy specimen (type of): [percentage value] of tumor.
    Necrosis in biopsy specimen (type of): absent.
    Necrosis in biopsy specimen (type of): none.
    Necrosis in biopsy specimen (type of): present.
    Necrosis in biopsy specimen (type of): unknown.
    
    Do not include explanations, reasoning, or any extra text — only one final annotation line exactly as specified below.
    
    ---
    
    Here are few examples for your understanding:
    Example:
    - Medical Note: Sono presenti aree di necrosi tumorale a focalità variabile. L'architettura è compatibile con un sarcoma p
        ... [truncated 2396 more characters] ...
    ----------------------------------------------------------------------
✗ Mismatch (sim: 0.00, 8.58s)
  Expected:  [NO EXPECTED ANNOTATION]
  Predicted: Necrosis in biopsy specimen (type): none.
    [66/93] tumorbiopsytype-int ... 
    Prompt (5081 chars):
    ----------------------------------------------------------------------
    You are a clinical information extraction assistant.  
    Your task: From the given medical note, extract the biopsy type and the date (if present).  
    If the date is missing, output 'unknown'.  
    If the place is not mentioned, output 'in the hospital'.  
    Always present the output in the following structured format:  
    
    Annotation: Baseline/primary tumor [biopsy type] biopsy has been performed on [date] in [place].
    
    ---
    
    Here are few examples for your understanding:
    Example:
    - Medical Note: Biopsia core del 12/05/2022: sarcoma pleomorfo con differenziazione lipogenica, istotipo coerente con pleomorphic liposarcoma (ICD-O-3 8858/3); grado FNCLCC 3 su materiale bioptico.
    - Annotation: Baseline/primary tumor core needle biopsy has been performed on 12/05/2022 in unknown
    
    Example:
    - Medical Note: Di
        ... [truncated 4281 more characters] ...
    ----------------------------------------------------------------------
✗ Mismatch (sim: 0.55, 14.58s)
  Expected:  Baseline/primary tumor CT-guided core biopsy has been performed on 15/09/2022 in lung (CT-guided core biopsy of dominant pulmonary nodule)
  Predicted: Baseline/primary tumor core biopsy has been performed on 15/09/2022 in unknown place
    [67/93] surgical-specimen-grading-int ... 
    Prompt (5180 chars):
    ----------------------------------------------------------------------
    You are a clinical information extraction assistant specialized in oncology.  
    Your task: From the given medical note, extract the **Surgical specimen grading (FNCLCC)** information.
    
    Guidelines:
    1. Identify explicit FNCLCC grades ('1' or '2' or '3' or 'Other classification system high' or 'Other classification system low').
    2. If no FNCLCC grade is mentioned but a grading level is implied using terms like “alto grado”, “basso grado”, or “intermedio”, interpret them as “Other classification system high/low/intermediate”.
    3. If both grading systems appear, prefer the FNCLCC value.
    4. If grading information is missing or uncertain, return nothing.
    5. The output must always follow this structured format:
    
    Annotation: Surgical specimen grading (FNCLCC): [grade or description].
    
    ---
    
    Here are f
        ... [truncated 4380 more characters] ...
    ----------------------------------------------------------------------
✗ Mismatch (sim: 0.00, 13.70s)
  Expected:  [NO EXPECTED ANNOTATION]
  Predicted: Surgical specimen grading (FNCLCC): 2
    [68/93] surgical-mitotic-count-int ... 
    Prompt (4126 chars):
    ----------------------------------------------------------------------
    You are a clinical information extraction assistant specialized in oncopathology.  
    Your task: From the given medical note, extract the **Surgical specimen mitotic count**.
    
    Guidelines:
    1. The Surgical specimen mitotic count can be easily found in the note where there is a mention of HPF succeeded by a value such as <1/10 HPF or >3/10 HPF or 10/10 HPF, etc. There may be a leading space between the numeric value and sign in some case. Return as it is.
    2. The output must strictly follow this format:
    
    Annotation: Surgical specimen mitotic count: [value].
    
    If the case corresponds to unknown or missing information, use:
    Annotation: Unknown surgical specimen mitotic count.
    
    ---
    
    Here are few examples for your understanding:
    Example:
    - Medical Note: Referto istopatologico definitivo del 20/06/202
        ... [truncated 3326 more characters] ...
    ----------------------------------------------------------------------
✗ Mismatch (sim: 0.00, 9.40s)
  Expected:  [NO EXPECTED ANNOTATION]
  Predicted: Unknown surgical specimen mitotic count
    [69/93] necrosis_in_surgical-int ... 
    Prompt (4374 chars):
    ----------------------------------------------------------------------
    Task: You are an expert medical annotator specializing in oncology pathology. Your task is to extract necrosis information from the provided medical note and output it in a precise, templated format.
    
    Possible Output Formats (use only one):
    Necrosis in surgical specimen (type of): 10%. 
    Necrosis in surgical specimen (type of): absent. 
    Necrosis in surgical specimen (type of): coagulative necrosis. 
    Necrosis in surgical specimen (type of): coagulative. 
    Necrosis in surgical specimen (type of): none. 
    Necrosis in surgical specimen (type of): unknown. 
    
    Do not include explanations, reasoning, or any extra text — only one final annotation line exactly as specified below.
    
    ---
    
    Here are few examples for your understanding:
    Example:
    - Medical Note: Referto istopatologico definitivo del 20/06/202
        ... [truncated 3574 more characters] ...
    ----------------------------------------------------------------------
✗ Mismatch (sim: 0.00, 11.26s)
  Expected:  [NO EXPECTED ANNOTATION]
  Predicted: Necrosis in surgical specimen (type): absent.
  Note P001_2022-09-15_pathology_13 completed in 91.81s (avg 11.477s per prompt)

  Processing note: P001_2022-09-25_oncology_14 (oncology)
    Filtered prompts: 6/27 prompts relevant to oncology
    [70/93] chemotherapy_start-int ... 
    Prompt (6259 chars):
    ----------------------------------------------------------------------
    Task: You are an expert medical annotator specializing in oncology pathology. Your task is to extract extract chemotherapy details from the provided medical note and output it in a precise, templated format.
    
    Formats:
    pre-operative chemotherapy with [select intent] started on [provide date] and utilized [select regimen] regimen.
    post-operative chemotherapy with [select intent] started on [provide date] and utilized [select regimen] regimen.
    
    Notes:
    If the date is missing, output [provide date].
    If the regimen is missing, output [select regimen].
    If the intent is missing, output [select intent].
    
    ---
    
    Here are few examples for your understanding:
    Example:
    - Medical Note: Referto TC torace eseguita il 10/06/2024 per valutazione di risposta a terapia sistemica (pleomorphic liposarcoma, tratta
        ... [truncated 5459 more characters] ...
    ----------------------------------------------------------------------
✗ Mismatch (sim: 0.63, 17.16s)
  Expected:  Intravenous anthracycline chemotherapy with palliative intent started on 25/09/2022 and utilized doxorubicin 75 mg/m2 q3w regimen (planned 6 cycles)
  Predicted: Systemic chemotherapy with palliative intent started on 25/09/2022 and utilized doxorubicin regimen.
    [71/93] chemotherapy_end-int ... 
    Prompt (5780 chars):
    ----------------------------------------------------------------------
    Task: You are an expert medical annotator specializing in oncology pathology. Your task is to extract extract chemotherapy details from the provided medical note and output it in a precise, templated format.
    
    Formats:
    pre-operative chemotherapy ended on [provide date] after [provide number] of cycles because of [select reason]
    post-operative chemotherapy ended on [provide date] after [provide number] of cycles because of [select reason]
    
    Notes:
    If the date is missing, output [provide date].
    If the reason is missing, output [select reason].
    If the number of cycles is missing, output [provide number].
    
    ---
    
    Here are few examples for your understanding:
    Example:
    - Medical Note: chemioterapia adiuvante VDC/IE completata 15/07/2020 e radioterapia al letto tumorale 54 Gy/27 fx iniziata 01/08/202
        ... [truncated 4980 more characters] ...
    ----------------------------------------------------------------------
✗ Mismatch (sim: 0.00, 23.71s)
  Expected:  [NO EXPECTED ANNOTATION]
  Predicted: Adjuvant chemotherapy ended on [provide date] after unknown number of cycles because of completion of planned treatment; regimen: VDC/IE
    [72/93] radiotherapy_start-int ... 
    Prompt (7040 chars):
    ----------------------------------------------------------------------
    Task: You are an expert medical annotator specializing in oncology pathology. Your task is to extract extract radiotherapy details from the provided medical note and output it in a precise, templated format.
    
    Formats:
    pre-operative radiotherapy (conventional) with [select intention] intention started [please select where] on [put date]. 
    post-operative radiotherapy (conventional) with [select intention] intention started [please select where] on [put date]. 
    
    Notes:
    If the date is missing, output [put date].
    If the place is missing, output [please select where].
    If the intention is missing, output [select intention].
    
    ---
    
    Here are few examples for your understanding:
    Example:
    - Medical Note: Terapia in corso: avviata oggi, 01/08/2022, radioterapia esterna adiuvante sul letto tumorale con 
        ... [truncated 6240 more characters] ...
    ----------------------------------------------------------------------
✗ Mismatch (sim: 0.00, 30.42s)
  Expected:  [NO EXPECTED ANNOTATION]
  Predicted: Pre-operative radiotherapy (conventional) with [select intention] intention started [please select where] on [put date].
    [73/93] radiotherapy_end-int ... 
    Prompt (5957 chars):
    ----------------------------------------------------------------------
    Task: You are an expert medical annotator specializing in oncology pathology. Your task is to extract extract radiotherapy details from the provided medical note and output it in a precise, templated format.
    
    Formats:
    pre-operative radiotherapy in total of [put total dose]Gy in [put number of] fractions ended on [put date] because of [select reason].
    post-operative radiotherapy in total of [put total dose]Gy in [put number of] fractions ended on [put date] because of [select reason].
    
    Notes:
    If the date is missing, output [put date].
    If the reason is missing, output [select reason].
    If the dose is missing, output [put total dose].
    If the number is missing, output [put number of].
    
    ---
    
    Here are few examples for your understanding:
    Example:
    - Medical Note: Breve anamnesi: paziente femmina, 
        ... [truncated 5157 more characters] ...
    ----------------------------------------------------------------------
✗ Mismatch (sim: 0.71, 17.23s)
  Expected:  External beam radiotherapy in total of 50 Gy in 25 fractions ended on 23/07/2018 because of planned completion (adjuvant to surgical bed)
  Predicted: Adjuvant radiotherapy in total of 50 Gy in 25 fractions ended on 23/07/2018 because of treatment completed
    [74/93] response-to-int ... 
    Prompt (6362 chars):
    ----------------------------------------------------------------------
    You are a clinical information extraction assistant specialized in oncology.  
    Your task: From the given medical note, identify and extract the **response to therapeutic treatment** (such as chemotherapy or radiotherapy) when no surgical procedure is performed.  
    
    Your goal is to:
    1. Detect the type of therapy mentioned (e.g., therapeutic (without surgery), therapeutic (radiotherapy without surgery), pre-operative, post-operative).
    2. Determine the disease response described (e.g., complete response, partial response, stable disease, progression).
    3. If the response type or therapy type is missing, leave it as “[select type]” or “[select response]”.
    4. Only output one concise, structured annotation per note.
    
    Always format your output strictly as one of the following:
    
    1. Response to [sele
        ... [truncated 5562 more characters] ...
    ----------------------------------------------------------------------
✗ Mismatch (sim: 0.00, 16.72s)
  Expected:  [NO EXPECTED ANNOTATION]
  Predicted: Response to palliative chemotherapy was: [select response]
    [75/93] patient-status-int ... 
    Prompt (8118 chars):
    ----------------------------------------------------------------------
    Task: From the given medical note, extract the status of the patient at last follow-up.
    
    Always output in exactly one of the following structured templates:
    
    1. Status of the patient at last follow-up: Alive, No Evidence of Disease (NED)
    2. Status of the patient at last follow-up: Alive With Disease (AWD) - metastases ([please select sites])
    3. Status of the patient at last follow-up: Alive With Disease (AWD) - localised tumor
    4. Status of the patient at last follow-up: Alive With Disease (AWD) - metastases (lung).
    5. Status of the patient at last follow-up: Alive With Disease (AWD) - metastases (lung. other).
    6. Status of the patient at last follow-up: Alive With Disease (AWD) - metastases (lung. soft tissue. other).
    8. Status of the patient at last follow-up: Alive With Disease (AWD) - l
        ... [truncated 7318 more characters] ...
    ----------------------------------------------------------------------
✓ Match (sim: 1.00, 23.38s)
  Expected:  Status of the patient at last follow-up: Alive With Disease (AWD) - metastases (lungs)
  Predicted: Status of the patient at last follow-up: Alive With Disease (AWD) - metastases (lungs)
  Note P001_2022-09-25_oncology_14 completed in 128.64s (avg 21.439s per prompt)

  Processing note: P001_2022-12-18_oncology_15 (oncology)
    Filtered prompts: 6/27 prompts relevant to oncology
    [76/93] chemotherapy_start-int ... 
    Prompt (6296 chars):
    ----------------------------------------------------------------------
    Task: You are an expert medical annotator specializing in oncology pathology. Your task is to extract extract chemotherapy details from the provided medical note and output it in a precise, templated format.
    
    Formats:
    pre-operative chemotherapy with [select intent] started on [provide date] and utilized [select regimen] regimen.
    post-operative chemotherapy with [select intent] started on [provide date] and utilized [select regimen] regimen.
    
    Notes:
    If the date is missing, output [provide date].
    If the regimen is missing, output [select regimen].
    If the intent is missing, output [select intent].
    
    ---
    
    Here are few examples for your understanding:
    Example:
    - Medical Note: Referto TC torace eseguita il 10/06/2024 per valutazione di risposta a terapia sistemica (pleomorphic liposarcoma, tratta
        ... [truncated 5496 more characters] ...
    ----------------------------------------------------------------------
✗ Mismatch (sim: 0.39, 27.35s)
  Expected:  Systemic chemotherapy with palliative intent started on 25/09/2022 and utilized doxorubicin regimen
  Predicted: pre-operative chemotherapy with [select intent] started on [provide date] and utilized [select regimen] regimen.
    [77/93] chemotherapy_end-int ... 
    Prompt (5817 chars):
    ----------------------------------------------------------------------
    Task: You are an expert medical annotator specializing in oncology pathology. Your task is to extract extract chemotherapy details from the provided medical note and output it in a precise, templated format.
    
    Formats:
    pre-operative chemotherapy ended on [provide date] after [provide number] of cycles because of [select reason]
    post-operative chemotherapy ended on [provide date] after [provide number] of cycles because of [select reason]
    
    Notes:
    If the date is missing, output [provide date].
    If the reason is missing, output [select reason].
    If the number of cycles is missing, output [provide number].
    
    ---
    
    Here are few examples for your understanding:
    Example:
    - Medical Note: chemioterapia adiuvante VDC/IE completata 15/07/2020 e radioterapia al letto tumorale 54 Gy/27 fx iniziata 01/08/202
        ... [truncated 5017 more characters] ...
    ----------------------------------------------------------------------
✗ Mismatch (sim: 0.50, 18.21s)
  Expected:  Systemic chemotherapy ended on 18/12/2022 after 6 cycles because of planned completion
  Predicted: Adjuvant chemotherapy ended on [provide date] after 6 cycles because of completion of planned treatment (regimen: doxorubicina)
    [78/93] radiotherapy_start-int ... 
    Prompt (7077 chars):
    ----------------------------------------------------------------------
    Task: You are an expert medical annotator specializing in oncology pathology. Your task is to extract extract radiotherapy details from the provided medical note and output it in a precise, templated format.
    
    Formats:
    pre-operative radiotherapy (conventional) with [select intention] intention started [please select where] on [put date]. 
    post-operative radiotherapy (conventional) with [select intention] intention started [please select where] on [put date]. 
    
    Notes:
    If the date is missing, output [put date].
    If the place is missing, output [please select where].
    If the intention is missing, output [select intention].
    
    ---
    
    Here are few examples for your understanding:
    Example:
    - Medical Note: Terapia in corso: avviata oggi, 01/08/2022, radioterapia esterna adiuvante sul letto tumorale con 
        ... [truncated 6277 more characters] ...
    ----------------------------------------------------------------------
✗ Mismatch (sim: 0.00, 19.81s)
  Expected:  [NO EXPECTED ANNOTATION]
  Predicted: External beam radiotherapy with adjuvant intention started on [put date]; total dose documented [put dose] in [put fractions] fractions.
    [79/93] radiotherapy_end-int ... 
    Prompt (5994 chars):
    ----------------------------------------------------------------------
    Task: You are an expert medical annotator specializing in oncology pathology. Your task is to extract extract radiotherapy details from the provided medical note and output it in a precise, templated format.
    
    Formats:
    pre-operative radiotherapy in total of [put total dose]Gy in [put number of] fractions ended on [put date] because of [select reason].
    post-operative radiotherapy in total of [put total dose]Gy in [put number of] fractions ended on [put date] because of [select reason].
    
    Notes:
    If the date is missing, output [put date].
    If the reason is missing, output [select reason].
    If the dose is missing, output [put total dose].
    If the number is missing, output [put number of].
    
    ---
    
    Here are few examples for your understanding:
    Example:
    - Medical Note: Breve anamnesi: paziente femmina, 
        ... [truncated 5194 more characters] ...
    ----------------------------------------------------------------------
✗ Mismatch (sim: 0.00, 24.68s)
  Expected:  [NO EXPECTED ANNOTATION]
  Predicted: Adjuvant radiotherapy in total of [put total dose]Gy in [put number of] fractions ended on 23/07/2018 because of treatment completed
    [80/93] response-to-int ... 
    Prompt (6399 chars):
    ----------------------------------------------------------------------
    You are a clinical information extraction assistant specialized in oncology.  
    Your task: From the given medical note, identify and extract the **response to therapeutic treatment** (such as chemotherapy or radiotherapy) when no surgical procedure is performed.  
    
    Your goal is to:
    1. Detect the type of therapy mentioned (e.g., therapeutic (without surgery), therapeutic (radiotherapy without surgery), pre-operative, post-operative).
    2. Determine the disease response described (e.g., complete response, partial response, stable disease, progression).
    3. If the response type or therapy type is missing, leave it as “[select type]” or “[select response]”.
    4. Only output one concise, structured annotation per note.
    
    Always format your output strictly as one of the following:
    
    1. Response to [sele
        ... [truncated 5599 more characters] ...
    ----------------------------------------------------------------------
✗ Mismatch (sim: 0.59, 42.85s)
  Expected:  Response to systemic chemotherapy was: Partial response (RECIST)
  Predicted: Response to systemic chemotherapy was: partial response (documented on CT 18/12/2022)
    [81/93] patient-status-int ... 
    Prompt (8214 chars):
    ----------------------------------------------------------------------
    Task: From the given medical note, extract the status of the patient at last follow-up.
    
    Always output in exactly one of the following structured templates:
    
    1. Status of the patient at last follow-up: Alive, No Evidence of Disease (NED)
    2. Status of the patient at last follow-up: Alive With Disease (AWD) - metastases ([please select sites])
    3. Status of the patient at last follow-up: Alive With Disease (AWD) - localised tumor
    4. Status of the patient at last follow-up: Alive With Disease (AWD) - metastases (lung).
    5. Status of the patient at last follow-up: Alive With Disease (AWD) - metastases (lung. other).
    6. Status of the patient at last follow-up: Alive With Disease (AWD) - metastases (lung. soft tissue. other).
    8. Status of the patient at last follow-up: Alive With Disease (AWD) - l
        ... [truncated 7414 more characters] ...
    ----------------------------------------------------------------------
✓ Match (sim: 1.00, 24.72s)
  Expected:  Status of the patient at last follow-up: Alive With Disease (AWD) - metastases (lungs)
  Predicted: Status of the patient at last follow-up: Alive With Disease (AWD) - metastases (lungs)
  Note P001_2022-12-18_oncology_15 completed in 157.63s (avg 26.271s per prompt)

  Processing note: P001_2023-08-10_radiology_16 (radiology)
    Filtered prompts: 3/27 prompts relevant to radiology
    [82/93] tumordiameter-int ... 
    Prompt (8022 chars):
    ----------------------------------------------------------------------
    You are an expert medical annotator specializing in oncology pathology. Your task is to extract extract the tumor longest diameter (in mm) and the date from the provided medical note and output it in a precise, templated format.
    
    Formats:
    Tumor longest diameter: [value]mm (at initial imaging on [date]).
    Tumor longest diameter unknown.
    
    If the date is missing, output [put date].  
    
    ---
    
    Here are few examples for your understanding:
    Example:
    - Medical Note: Referto TC torace — 20/09/2022
    
    Tecnica: TC torace eseguita il 20/09/2022 con acquisizioni ad alta risoluzione per studio nodulare polmonare.
    
    Risultati: si evidenziano due noduli polmonari di nuova insorgenza rispetto agli esami precedenti. Nel lobo inferiore destro, segmento basale, nodulo solido di 8 mm di diametro massimo; nel lobo su
        ... [truncated 7222 more characters] ...
    ----------------------------------------------------------------------
✗ Mismatch (sim: 0.58, 24.94s)
  Expected:  Tumor longest diameter: 110 mm (at initial imaging on unknown)
  Predicted: Tumor longest diameter: 15 mm (at initial imaging on 01/09/2022).
    [83/93] tumordepth-int ... 
    Prompt (5408 chars):
    ----------------------------------------------------------------------
    You are a clinical information extraction assistant specialized in oncology pathology and radiology reports.
    
    Task:
    From the given medical note, determine the tumor depth and output **only one** of the two values: `superficial` or `deep`.
    
    Output format (exact):
    Annotation: Tumor depth: [superficial|deep].
    
    ---
    
    Here are few examples for your understanding:
    Example:
    - Medical Note: Riscontri: a livello del dorso del piede destro si evidenzia formazione nodulare sottocutanea, ben delimitata, di morfologia ovale, a prevalente ecostruttura ipoechogenica, dimensioni approssimative 20 x 15 mm (massima misura 20 mm). ... Conclusione: massa sottocutanea ipoechogenica del dorso del piede destro, 20 x 15 mm, ben delimitata; aspetti ecografici non specifici ma compatibili con lesione solida. ... Il 
        ... [truncated 4608 more characters] ...
    ----------------------------------------------------------------------
✗ Mismatch (sim: 0.00, 19.92s)
  Expected:  [NO EXPECTED ANNOTATION]
  Predicted: Tumor depth: superficial
    [84/93] tumorsite-int ... 
    Prompt (8581 chars):
    ----------------------------------------------------------------------
    Task:
    You are a clinical information extraction assistant.
    From the provided medical note, identify the tumor location category and the exact tumor site.
    
    Instructions:
    
    1. Read the note carefully and find the actual tumor site mentioned for the current case, not historical disease, treatment site, or previous surgery.
    
    2. Determine the broader anatomical category that best fits the tumor site (e.g., Upper and Lower limbs, Trunk wall, Intra abdominal, Genito urinary, Head and neck, Breast).
    
    3. Then specify the exact site (e.g., Upper leg, Groin, Thoracic wall, Paravertebral – thoracolumbar, skin of right breast, etc.).
    
    4. When both an organ and a surface or subregion are mentioned, prioritize the most specific surface or subregion (e.g., “skin of right breast” → not Breast).
    
    5. When ter
        ... [truncated 7781 more characters] ...
    ----------------------------------------------------------------------
✗ Mismatch (sim: 0.18, 24.88s)
  Expected:  Tumor site (Upper and Lower limbs): Left thigh (anterior compartment)
  Predicted: Tumor site (Head and neck): multipli noduli polmonari a sede bilaterale.
  Note P001_2023-08-10_radiology_16 completed in 69.73s (avg 23.244s per prompt)

  Processing note: P001_2023-08-25_oncology_17 (oncology)
    Filtered prompts: 6/27 prompts relevant to oncology
    [85/93] chemotherapy_start-int ... 
    Prompt (6359 chars):
    ----------------------------------------------------------------------
    Task: You are an expert medical annotator specializing in oncology pathology. Your task is to extract extract chemotherapy details from the provided medical note and output it in a precise, templated format.
    
    Formats:
    pre-operative chemotherapy with [select intent] started on [provide date] and utilized [select regimen] regimen.
    post-operative chemotherapy with [select intent] started on [provide date] and utilized [select regimen] regimen.
    
    Notes:
    If the date is missing, output [provide date].
    If the regimen is missing, output [select regimen].
    If the intent is missing, output [select intent].
    
    ---
    
    Here are few examples for your understanding:
    Example:
    - Medical Note: Referto TC torace eseguita il 10/06/2024 per valutazione di risposta a terapia sistemica (pleomorphic liposarcoma, tratta
        ... [truncated 5559 more characters] ...
    ----------------------------------------------------------------------
✗ Mismatch (sim: 0.65, 17.43s)
  Expected:  systemic chemotherapy with palliative intent started on 25/09/2022 and utilized doxorubicin regimen
  Predicted: Systemic chemotherapy with palliative intent started on 25/08/2023 and utilized trabectedin regimen.
    [86/93] chemotherapy_end-int ... 
    Prompt (6059 chars):
    ----------------------------------------------------------------------
    Task: You are an expert medical annotator specializing in oncology pathology. Your task is to extract extract chemotherapy details from the provided medical note and output it in a precise, templated format.
    
    Formats:
    pre-operative chemotherapy ended on [provide date] after [provide number] of cycles because of [select reason]
    post-operative chemotherapy ended on [provide date] after [provide number] of cycles because of [select reason]
    
    Notes:
    If the date is missing, output [provide date].
    If the reason is missing, output [select reason].
    If the number of cycles is missing, output [provide number].
    
    ---
    
    Here are few examples for your understanding:
    Example:
    - Medical Note: È stata avviata chemioterapia palliativa con gemcitabina il 05/03/2024; controllo radiologico del 10/06/2024 ha docu
        ... [truncated 5259 more characters] ...
    ----------------------------------------------------------------------
✗ Mismatch (sim: 0.40, 25.76s)
  Expected:  systemic chemotherapy ended on 18/12/2022 after 6 cycles because of completion of planned cycles
  Predicted: pre-operative chemotherapy ended on [provide date] after [provide number] of cycles because of [select reason]
    [87/93] radiotherapy_start-int ... 
    Prompt (7140 chars):
    ----------------------------------------------------------------------
    Task: You are an expert medical annotator specializing in oncology pathology. Your task is to extract extract radiotherapy details from the provided medical note and output it in a precise, templated format.
    
    Formats:
    pre-operative radiotherapy (conventional) with [select intention] intention started [please select where] on [put date]. 
    post-operative radiotherapy (conventional) with [select intention] intention started [please select where] on [put date]. 
    
    Notes:
    If the date is missing, output [put date].
    If the place is missing, output [please select where].
    If the intention is missing, output [select intention].
    
    ---
    
    Here are few examples for your understanding:
    Example:
    - Medical Note: Referto TC torace — 20/09/2022
    
    Tecnica: TC torace eseguita il 20/09/2022 con acquisizioni ad alta
        ... [truncated 6340 more characters] ...
    ----------------------------------------------------------------------
✗ Mismatch (sim: 0.00, 30.87s)
  Expected:  [NO EXPECTED ANNOTATION]
  Predicted: pre-operative radiotherapy (conventional) with [select intention] intention started [please select where] on [put date].
    [88/93] radiotherapy_end-int ... 
    Prompt (6057 chars):
    ----------------------------------------------------------------------
    Task: You are an expert medical annotator specializing in oncology pathology. Your task is to extract extract radiotherapy details from the provided medical note and output it in a precise, templated format.
    
    Formats:
    pre-operative radiotherapy in total of [put total dose]Gy in [put number of] fractions ended on [put date] because of [select reason].
    post-operative radiotherapy in total of [put total dose]Gy in [put number of] fractions ended on [put date] because of [select reason].
    
    Notes:
    If the date is missing, output [put date].
    If the reason is missing, output [select reason].
    If the dose is missing, output [put total dose].
    If the number is missing, output [put number of].
    
    ---
    
    Here are few examples for your understanding:
    Example:
    - Medical Note: Breve anamnesi: paziente femmina, 
        ... [truncated 5257 more characters] ...
    ----------------------------------------------------------------------
✗ Mismatch (sim: 0.00, 29.67s)
  Expected:  [NO EXPECTED ANNOTATION]
  Predicted: Adjuvant radiotherapy in total of [put total dose]Gy in [put number of] fractions ended on [put date] because of [select reason].
    [89/93] response-to-int ... 
    Prompt (6462 chars):
    ----------------------------------------------------------------------
    You are a clinical information extraction assistant specialized in oncology.  
    Your task: From the given medical note, identify and extract the **response to therapeutic treatment** (such as chemotherapy or radiotherapy) when no surgical procedure is performed.  
    
    Your goal is to:
    1. Detect the type of therapy mentioned (e.g., therapeutic (without surgery), therapeutic (radiotherapy without surgery), pre-operative, post-operative).
    2. Determine the disease response described (e.g., complete response, partial response, stable disease, progression).
    3. If the response type or therapy type is missing, leave it as “[select type]” or “[select response]”.
    4. Only output one concise, structured annotation per note.
    
    Always format your output strictly as one of the following:
    
    1. Response to [sele
        ... [truncated 5662 more characters] ...
    ----------------------------------------------------------------------
✗ Mismatch (sim: 0.22, 15.95s)
  Expected:  Response to systemic chemotherapy (first-line doxorubicin) was: Partial response (PR) (evaluated 18/12/2022)
  Predicted: Response to palliative chemotherapy was: progressive disease (documented on 10/08/2023)
    [90/93] patient-status-int ... 
    Prompt (8512 chars):
    ----------------------------------------------------------------------
    Task: From the given medical note, extract the status of the patient at last follow-up.
    
    Always output in exactly one of the following structured templates:
    
    1. Status of the patient at last follow-up: Alive, No Evidence of Disease (NED)
    2. Status of the patient at last follow-up: Alive With Disease (AWD) - metastases ([please select sites])
    3. Status of the patient at last follow-up: Alive With Disease (AWD) - localised tumor
    4. Status of the patient at last follow-up: Alive With Disease (AWD) - metastases (lung).
    5. Status of the patient at last follow-up: Alive With Disease (AWD) - metastases (lung. other).
    6. Status of the patient at last follow-up: Alive With Disease (AWD) - metastases (lung. soft tissue. other).
    8. Status of the patient at last follow-up: Alive With Disease (AWD) - l
        ... [truncated 7712 more characters] ...
    ----------------------------------------------------------------------
✓ Match (sim: 1.00, 23.43s)
  Expected:  Status of the patient at last follow-up: Alive With Disease (AWD) - metastases (lungs)
  Predicted: Status of the patient at last follow-up: Alive With Disease (AWD) - metastases (lungs)
  Note P001_2023-08-25_oncology_17 completed in 143.10s (avg 23.850s per prompt)

  Processing note: P001_2024-03-01_follow-up_18 (follow-up)
    Filtered prompts: 3/27 prompts relevant to follow-up
    [91/93] patient-status-int ... 
    Prompt (8287 chars):
    ----------------------------------------------------------------------
    Task: From the given medical note, extract the status of the patient at last follow-up.
    
    Always output in exactly one of the following structured templates:
    
    1. Status of the patient at last follow-up: Alive, No Evidence of Disease (NED)
    2. Status of the patient at last follow-up: Alive With Disease (AWD) - metastases ([please select sites])
    3. Status of the patient at last follow-up: Alive With Disease (AWD) - localised tumor
    4. Status of the patient at last follow-up: Alive With Disease (AWD) - metastases (lung).
    5. Status of the patient at last follow-up: Alive With Disease (AWD) - metastases (lung. other).
    6. Status of the patient at last follow-up: Alive With Disease (AWD) - metastases (lung. soft tissue. other).
    8. Status of the patient at last follow-up: Alive With Disease (AWD) - l
        ... [truncated 7487 more characters] ...
    ----------------------------------------------------------------------
✓ Match (sim: 1.00, 17.57s)
  Expected:  Status of the patient at last follow-up: Alive With Disease (AWD) - metastases (lungs)
  Predicted: Status of the patient at last follow-up: Alive With Disease (AWD) - metastases (lungs)
    [92/93] recur_or_prog-int ... 
    Prompt (6196 chars):
    ----------------------------------------------------------------------
    Task: You are a medical text annotation assistant. Your task is to determine if the note indicates progression, recurrence, no progression, or no recurrence of the disease. If progression or recurrence is mentioned, also extract the date if available.
    
    Follow these rules:
    
    If the note clearly states no progression or no recurrence, output:
    "There was no progression/recurrence."
    
    If the note mentions recurrence, output:
    "There was a recurrence on [date]." (If a date is mentioned, include it. If no date is mentioned, keep [put date]).
    
    If the note mentions progression, output:
    "There was a progression on [date]." (If a date is mentioned, include it. If no date is mentioned, keep [put date]).
    
    Never add extra explanation. Only output the standardized annotation.
    
    ---
    
    Here are few examples fo
        ... [truncated 5396 more characters] ...
    ----------------------------------------------------------------------
✗ Mismatch (sim: 0.34, 15.58s)
  Expected:  There was a progression on 10/08/2023
  Predicted: There was no progression/recurrence.
    [93/93] recurrencetype-int ... 
    Prompt (7703 chars):
    ----------------------------------------------------------------------
    Task: You are a clinical information extraction assistant.
    Your task is to extract information regarding the type of recurrence or progression of the disease. Use only the templates listed below and strictly adhere to the structure. If multiple metastatic sites are mentioned, list them in the template exactly as they appear. If no relevant information is present, return "None".
    
    Output strictly in the following format:
    Annotation: Type of recurrence/progression: [selected type] .
    
    Possible Output Templates:
    Type of recurrence/progression: local.
    Type of recurrence/progression: local [select site if metastatic].
    Type of recurrence/progression: metastatic.
    Type of recurrence/progression: metastatic bone, soft tissue.
    Type of recurrence/progression: metastatic bone.
    Type of recurrence/progres
        ... [truncated 6903 more characters] ...
    ----------------------------------------------------------------------
✗ Mismatch (sim: 0.00, 20.36s)
  Expected:  [NO EXPECTED ANNOTATION]
  Predicted: Type of recurrence/progression: metastatic - lungs.
  Note P001_2024-03-01_follow-up_18 completed in 53.51s (avg 17.838s per prompt)

  [STEP 5 completed in 1600.36s]

[STEP 6] Generating evaluation reports...
  Detailed results saved to: /home/zulaika/IDEA4RC-NLP-Ingestion/api/nlp/llm_evaluation_detailed.csv
    Includes note text and annotations for easy comparison
  Summary saved to: /home/zulaika/IDEA4RC-NLP-Ingestion/api/nlp/llm_evaluation_summary.csv
  [Time: 0.05s]
  JSON report saved to: /home/zulaika/IDEA4RC-NLP-Ingestion/api/nlp/llm_evaluation_report.json

================================================================================
EVALUATION SUMMARY
================================================================================
Total evaluations: 93
Exact matches: 9 (9.7%)
High similarity (≥0.8): 27 (29.0%)
Overall matches: 27 (29.0%)
Average similarity: 0.442
Average value match rate: 18.2%

--------------------------------------------------------------------------------
TIMING SUMMARY
--------------------------------------------------------------------------------
Total execution time: 0:26:49 (1609.94 seconds)
Average time per evaluation: 17.208 seconds
Average time per note: 88.91 seconds
Fastest note: 21.29s
Slowest note: 191.56s
================================================================================
